<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DevNet Associate Complete Quiz (Modules 5-8)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = { darkMode: 'class' }
    </script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
        .fade-in { animation: fadeIn 0.3s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .option-label { transition: all 0.2s; }
        .option-input:checked + .option-label { border-color: #2563EB; background-color: #EFF6FF; }
        .dark .option-input:checked + .option-label { border-color: #3b82f6; background-color: #1e3a5f; }
        .correct-answer { border-color: #10B981 !important; background-color: #D1FAE5 !important; }
        .dark .correct-answer { border-color: #10B981 !important; background-color: #064e3b !important; color: #a7f3d0 !important; }
        .incorrect-answer { border-color: #EF4444 !important; background-color: #FEE2E2 !important; }
        .dark .incorrect-answer { border-color: #EF4444 !important; background-color: #7f1d1d !important; color: #fecaca !important; }
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
        .dark ::-webkit-scrollbar-track { background: #1e293b; }
        .dark ::-webkit-scrollbar-thumb { background: #475569; }
        /* Drag and Drop Styles */
        .drag-item { transition: all 0.2s; cursor: grab; user-select: none; }
        .drag-item:active { cursor: grabbing; }
        .drag-item.dragging { opacity: 0.5; transform: scale(0.95); }
        .drag-item.used { opacity: 0.4; cursor: not-allowed; background-color: #f1f5f9; }
        .dark .drag-item.used { background-color: #334155; }
        .drop-zone { min-height: 44px; transition: all 0.2s; border: 2px dashed #cbd5e1; }
        .dark .drop-zone { border-color: #475569; }
        .drop-zone.drag-over { border-color: #2563eb; background-color: #eff6ff; transform: scale(1.02); }
        .dark .drop-zone.drag-over { background-color: #1e3a5f; }
        .drop-zone.filled { border-style: solid; border-color: #2563eb; background-color: #eff6ff; cursor: pointer; }
        .dark .drop-zone.filled { background-color: #1e3a5f; }
        .drop-zone.correct { border-color: #10B981 !important; background-color: #D1FAE5 !important; }
        .dark .drop-zone.correct { background-color: #064e3b !important; }
        .drop-zone.incorrect { border-color: #EF4444 !important; background-color: #FEE2E2 !important; }
        .dark .drop-zone.incorrect { background-color: #7f1d1d !important; }
        .match-arrow { color: #64748b; }
        /* Dark mode toggle animation */
        .theme-toggle { transition: transform 0.3s ease; }
        .theme-toggle:hover { transform: rotate(15deg); }
        /* Mobile improvements */
        @media (max-width: 640px) {
            .drag-item, .drop-zone { font-size: 0.875rem; padding: 0.625rem !important; }
            .drag-item { touch-action: none; }
        }
        .drag-item.dragging { opacity: 0.5; transform: scale(0.95); background-color: #dbeafe !important; }
        .dark .drag-item.dragging { background-color: #1e3a5f !important; }
        /* Toast notification styles */
        .toast {
            position: fixed;
            top: -100px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 9999;
            transition: top 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }
        .toast.show { top: 20px; }
        .toast-content {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px 24px;
            border-radius: 50px;
            font-weight: 600;
            font-size: 14px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2), 0 0 0 1px rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
        }
        .toast-on {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            color: white;
        }
        .toast-off {
            background: linear-gradient(135deg, #64748b 0%, #475569 100%);
            color: white;
        }
        .toast-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }
        .toast-on .toast-icon { background: rgba(255,255,255,0.25); }
        .toast-off .toast-icon { background: rgba(255,255,255,0.2); }
    </style>
</head>
<body class="bg-slate-100 dark:bg-slate-900 text-slate-800 dark:text-slate-200 min-h-screen flex flex-col transition-colors duration-300">

    <!-- Toast Notification -->
    <div id="toast" class="toast">
        <div id="toast-content" class="toast-content toast-on">
            <span id="toast-icon" class="toast-icon"><i class="fa-solid fa-bolt"></i></span>
            <span id="toast-message">Auto Check is on</span>
        </div>
    </div>

    <header class="bg-white dark:bg-slate-800 shadow-sm sticky top-0 z-20 transition-colors">
        <div class="max-w-4xl mx-auto px-3 sm:px-4 py-3 flex flex-col sm:flex-row justify-between items-center gap-2 sm:gap-3">
            <h1 class="text-lg sm:text-xl font-bold text-slate-900 dark:text-white flex items-center gap-2">
                <i class="fa-solid fa-code-branch text-blue-600 dark:text-blue-400"></i>
                <span class="hidden xs:inline">DevNet Associate</span>
                <span class="xs:hidden">DevNet</span>
                <span class="text-slate-400 dark:text-slate-500 font-normal text-xs sm:text-sm ml-1 hidden md:inline">Modules 5-8 (65 Questions)</span>
            </h1>
            <div class="flex items-center gap-2 sm:gap-4 w-full sm:w-auto justify-between sm:justify-end">
                <select id="module-filter" onchange="filterQuestions()" class="bg-slate-50 dark:bg-slate-700 border border-slate-300 dark:border-slate-600 text-slate-700 dark:text-slate-200 text-xs sm:text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-1.5 sm:p-2 flex-1 sm:flex-none max-w-[180px] sm:max-w-none">
                    <option value="all">All Modules (65)</option>
                    <option value="5">Module 5: Network Fundamentals (19)</option>
                    <option value="6">Module 6: App Deployment & Security (15)</option>
                    <option value="7">Module 7: Infrastructure & Automation (16)</option>
                    <option value="8">Module 8: Cisco Platforms (15)</option>
                    <option value="final">üìù Final Exam (Mod 5-8 Only)</option>
                    <option value="netacad">üéì Netacad Quizzes (Combined)</option>
                </select>
                <div class="text-xs sm:text-sm font-medium text-slate-500 dark:text-slate-400 bg-slate-100 dark:bg-slate-700 px-2 sm:px-3 py-1 rounded-full whitespace-nowrap">
                    <span id="current-q-num">1</span> / <span id="total-q-num">--</span>
                </div>
                <button onclick="toggleDarkMode()" class="theme-toggle p-2 rounded-lg bg-slate-100 dark:bg-slate-700 hover:bg-slate-200 dark:hover:bg-slate-600 transition-colors" title="Toggle Dark Mode">
                    <i class="fa-solid fa-moon text-slate-600 dark:hidden"></i>
                    <i class="fa-solid fa-sun text-yellow-400 hidden dark:inline"></i>
                </button>
                <button id="auto-reveal-btn" onclick="toggleAutoReveal()" class="p-2 rounded-lg bg-slate-100 dark:bg-slate-700 hover:bg-slate-200 dark:hover:bg-slate-600 transition-colors" title="Auto Reveal (off)">
                    <i class="fa-solid fa-bolt text-slate-400 dark:text-slate-500"></i>
                </button>
            </div>
        </div>
    </header>

    <main class="flex-grow p-2 sm:p-4">
        <div class="max-w-3xl mx-auto">
            <!-- Question Navigator -->
            <div id="question-nav" class="mb-4 sm:mb-6">
                <div class="flex items-center gap-2 mb-2">
                    <div class="w-full bg-slate-200 dark:bg-slate-700 rounded-full h-2 flex-grow">
                        <div id="progress-bar" class="bg-blue-600 dark:bg-blue-500 h-2 rounded-full transition-all duration-300" style="width: 0%"></div>
                    </div>
                </div>
                <div id="question-dots" class="flex flex-wrap gap-1.5 justify-center"></div>
            </div>
            <div id="quiz-container" class="bg-white dark:bg-slate-800 rounded-xl shadow-lg p-4 sm:p-6 md:p-8 relative overflow-hidden min-h-[350px] sm:min-h-[400px] transition-colors"></div>
            <div id="quiz-controls" class="mt-4 sm:mt-6 flex flex-col sm:flex-row justify-between gap-3 sm:gap-4 sticky bottom-2 sm:bottom-4 z-10">
                <!-- Desktop: Prev | Reset Reveal | Next -->
                <!-- Mobile: Reset Reveal (top) | Prev Next (bottom) -->
                
                <!-- Prev button - hidden on mobile, shown on desktop -->
                <button id="prev-btn" onclick="prevQuestion()" class="hidden sm:flex shadow-md px-4 sm:px-6 py-2.5 sm:py-3 bg-white dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-lg text-slate-700 dark:text-slate-200 font-medium hover:bg-slate-50 dark:hover:bg-slate-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed items-center justify-center gap-2 text-sm sm:text-base">
                    <i class="fa-solid fa-arrow-left"></i> <span>Previous</span>
                </button>
                
                <!-- Reset and Reveal buttons - first row on mobile -->
                <div class="flex gap-2 sm:gap-3 w-full sm:w-auto order-first sm:order-none">
                    <button id="shuffle-btn" onclick="shuffleQuestions()" class="shadow-md flex-1 sm:flex-none px-3 sm:px-6 py-2.5 sm:py-3 bg-fuchsia-50 dark:bg-fuchsia-900/30 border border-fuchsia-200 dark:border-fuchsia-700 text-fuchsia-700 dark:text-fuchsia-400 rounded-lg font-medium hover:bg-fuchsia-100 dark:hover:bg-fuchsia-900/50 transition-colors flex items-center justify-center gap-2 text-sm sm:text-base">
                        <i class="fa-solid fa-shuffle"></i> Shuffle
                    </button>
                    <button id="reset-btn" onclick="resetCurrentQuestion()" class="shadow-md flex-1 sm:flex-none px-3 sm:px-6 py-2.5 sm:py-3 bg-yellow-50 dark:bg-yellow-900/30 border border-yellow-200 dark:border-yellow-700 text-yellow-700 dark:text-yellow-400 rounded-lg font-medium hover:bg-yellow-100 dark:hover:bg-yellow-900/50 transition-colors flex items-center justify-center gap-2 text-sm sm:text-base">
                        <i class="fa-solid fa-rotate-right"></i> Reset
                    </button>
                    <button id="retake-btn-nav" onclick="retakeQuiz()" class="hidden shadow-md flex-1 sm:flex-none px-3 sm:px-6 py-2.5 sm:py-3 bg-slate-200 dark:bg-slate-600 border border-slate-300 dark:border-slate-500 text-slate-700 dark:text-slate-200 rounded-lg font-medium hover:bg-slate-300 dark:hover:bg-slate-500 transition-colors items-center justify-center gap-2 text-sm sm:text-base">
                        <i class="fa-solid fa-arrows-rotate"></i> Retake
                    </button>
                    <button id="reveal-btn" onclick="revealAnswer()" class="shadow-md flex-1 sm:flex-none px-3 sm:px-6 py-2.5 sm:py-3 bg-indigo-50 dark:bg-indigo-900/30 border border-indigo-200 dark:border-indigo-700 text-indigo-700 dark:text-indigo-400 rounded-lg font-medium hover:bg-indigo-100 dark:hover:bg-indigo-900/50 transition-colors flex items-center justify-center gap-2 text-sm sm:text-base">
                        <i class="fa-solid fa-eye"></i> Reveal
                    </button>
                </div>
                
                <!-- Next button - hidden on mobile, shown on desktop -->
                <button id="next-btn-desktop" onclick="nextQuestion()" class="hidden sm:flex shadow-md px-4 sm:px-6 py-2.5 sm:py-3 bg-blue-600 dark:bg-blue-500 text-white rounded-lg font-medium hover:bg-blue-700 dark:hover:bg-blue-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed items-center justify-center gap-2 text-sm sm:text-base">
                    Next <i class="fa-solid fa-arrow-right"></i>
                </button>
                
                <!-- Mobile only: Prev and Next row -->
                <div class="flex sm:hidden gap-2 w-full order-last">
                    <button id="prev-btn-mobile" onclick="prevQuestion()" class="shadow-md flex-1 px-4 py-2.5 bg-white dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-lg text-slate-700 dark:text-slate-200 font-medium hover:bg-slate-50 dark:hover:bg-slate-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 text-sm">
                        <i class="fa-solid fa-arrow-left"></i> Prev
                    </button>
                    <button id="next-btn-mobile" onclick="nextQuestion()" class="shadow-md flex-1 px-4 py-2.5 bg-blue-600 dark:bg-blue-500 text-white rounded-lg font-medium hover:bg-blue-700 dark:hover:bg-blue-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 text-sm">
                        Next <i class="fa-solid fa-arrow-right"></i>
                    </button>
                </div>
            </div>
        </div>
    </main>

    <footer class="bg-slate-50 dark:bg-slate-800 border-t border-slate-200 dark:border-slate-700 mt-auto py-4 sm:py-6 transition-colors">
        <div class="max-w-3xl mx-auto px-4 text-center text-slate-500 dark:text-slate-400 text-xs sm:text-sm">
            <p>Complete Study Set: DevNet Associate Modules 5, 6, 7, & 8 (65 Questions)</p>
        </div>
    </footer>

    <!-- Custom Confirmation Modal -->
    <div id="confirm-modal" class="fixed inset-0 bg-slate-900/50 backdrop-blur-sm z-50 hidden flex items-center justify-center transition-opacity opacity-0" style="transition: opacity 0.2s ease-in-out;">
        <div class="bg-white dark:bg-slate-800 rounded-2xl shadow-2xl p-6 max-w-sm w-full mx-4 border border-slate-200 dark:border-slate-700 transform scale-95 transition-transform duration-200" id="modal-content">
            <div class="text-center">
                <div class="w-14 h-14 rounded-full bg-fuchsia-100 dark:bg-fuchsia-900/30 text-fuchsia-600 dark:text-fuchsia-400 mx-auto flex items-center justify-center mb-4 ring-4 ring-fuchsia-50 dark:ring-fuchsia-900/20">
                    <i class="fa-solid fa-dice text-2xl"></i>
                </div>
                <h3 class="text-xl font-bold text-slate-900 dark:text-white mb-2">Shuffle Questions?</h3>
                <p class="text-sm text-slate-500 dark:text-slate-400 mb-6 leading-relaxed">
                    This will randomize the order of all questions and answer choices in the current quiz.
                </p>
                <div class="flex gap-3 justify-center">
                    <button onclick="closeConfirmModal()" class="flex-1 px-4 py-2.5 bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-300 rounded-xl font-medium hover:bg-slate-200 dark:hover:bg-slate-600 transition-colors">
                        Cancel
                    </button>
                    <button onclick="confirmShuffle()" class="flex-1 px-4 py-2.5 bg-fuchsia-600 text-white rounded-xl font-medium hover:bg-fuchsia-700 shadow-lg shadow-fuchsia-600/20 transition-all hover:scale-[1.02]">
                        Yes, Shuffle
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        const allQuizData = [
            // ========== MODULE 5: Network Fundamentals (19 Questions) ==========
            {id:501,module:"5",question:"What command can a technician use on a computer to see if DNS is functioning properly?",options:["ipconfig","net share","nslookup","net use"],correctIndex:2,explanation:"The <strong>nslookup</strong> command is used to query the Domain Name System (DNS) to obtain domain name or IP address mapping."},
            {id:502,module:"5",question:"Which two OSI model layers have the same functionality as two layers of the TCP/IP model? (Choose two.)",options:["physical","data link","network","transport","session"],correctIndices:[2,3],type:"multi",explanation:"The OSI <strong>transport</strong> layer is functionally equivalent to the TCP/IP transport layer, and the OSI <strong>network</strong> layer is equivalent to the TCP/IP Internet layer."},
            {id:503,module:"5",question:"What is one advantage of using the cut-through switching method instead of the store-and-forward switching method?",options:["provides the flexibility to support any of Ethernet speeds","has a lower latency appropriate for high-performance computing applications","makes a fast forwarding decision based on the source MAC address of the frame","has a positive impact on bandwidth by dropping most of the invalid frames"],correctIndex:1,explanation:"<strong>Cut-through switching</strong> provides lower latency switching for high-performance computing (HPC) applications."},
            {id:504,module:"5",question:"Which solution improves web response time by deploying multiple web servers and DNS servers?",options:["memcaching","distributed databases","sharding","load balancing"],correctIndex:3,explanation:"<strong>Load balancing</strong> involves deploying multiple web servers and DNS servers to respond to requests simultaneously."},
            {id:505,module:"5",question:"What will a host on an Ethernet network do if it receives a frame with a unicast destination MAC address that does not match its own MAC address?",options:["It will remove the frame from the media.","It will forward the frame to the next host.","It will strip off the data-link frame to check the destination IP address.","It will discard the frame."],correctIndex:3,explanation:"If the destination MAC address does not match the device's own MAC address, the NIC <strong>discards the frame</strong>."},
            {id:506,module:"5",question:"What is the common term given to SNMP log messages that are generated by network devices and sent to the SNMP server?",options:["auditing","warnings","acknowledgments","traps"],correctIndex:3,explanation:"Log messages sent from an SNMP agent to the manager to notify of an event are called <strong>Traps</strong>."},
            {id:507,module:"5",question:"What is the function of the Nslookup utility?",options:["to manually force a client to send a DHCP request","to display all cached DNS entries on a host","to view the network settings on a host","to manually query the name servers to resolve a given host name"],correctIndex:3,explanation:"<strong>Nslookup</strong> is a command-line utility that is used to send a query to DNS servers to resolve a specific host name to an IP address."},
            {id:508,module:"5",question:"What type of address is 01-00-5E-0A-00-02?",options:["an address that reaches every host in the network","an address that reaches every host inside a local subnet","an address that reaches a specific group of hosts","an address that reaches one specific host"],correctIndex:2,explanation:"The multicast MAC address begins with <strong>01-00-5E</strong> in hexadecimal. It allows a source device to send a packet to a group of devices."},
            {id:509,module:"5",question:"Refer to the exhibit. The PC is sending a packet to the Server on the remote network. Router R1 is performing NAT overload. From the perspective of the PC, match the NAT address type with the correct IP address. (Not all options are used.)",image:"images/q509_nat_matching.png",type:"matching",matchData:{leftItems:["Inside Local","Inside Global","Outside Global"],rightItems:["10.130.5.76","192.0.2.1","203.0.113.5","203.0.113.14","192.0.2.2","10.130.5.1"],correctPairs:{"Inside Local":"10.130.5.76","Inside Global":"192.0.2.1","Outside Global":"203.0.113.5"}},explanation:"From the PC's perspective: <strong>Inside Local</strong> = 10.130.5.76 (PC's private IP). <strong>Inside Global</strong> = 192.0.2.1 (R1's S0/0/0 interface - the translated address). <strong>Outside Global</strong> = 203.0.113.5 (server's public IP)."},
            {id:510,module:"5",question:"Match the OSI layer to the layer number. (Not all options are used.)",type:"matching",matchData:{leftItems:["Layer 1","Layer 2","Layer 3","Layer 4","Layer 5","Layer 6","Layer 7"],rightItems:["Physical Layer","Data Link Layer","Network Layer","Transport Layer","Session Layer","Presentation Layer","Application Layer","Internet Layer","Network Access Layer"],correctPairs:{"Layer 1":"Physical Layer","Layer 2":"Data Link Layer","Layer 3":"Network Layer","Layer 4":"Transport Layer","Layer 5":"Session Layer","Layer 6":"Presentation Layer","Layer 7":"Application Layer"}},explanation:"OSI Model: <strong>Layer 1</strong> = Physical. <strong>Layer 2</strong> = Data Link. <strong>Layer 3</strong> = Network. <strong>Layer 4</strong> = Transport. <strong>Layer 5</strong> = Session. <strong>Layer 6</strong> = Presentation. <strong>Layer 7</strong> = Application. (Internet Layer and Network Access Layer are TCP/IP model layers, not used.)"},
            {id:511,module:"5",question:"A high school in New York (school A) is using videoconferencing technology to establish student interactions with another high school (school B) in Russia. The network administrator of school A configures the end device with the IP address 209.165.201.10. The response IP for school B is 192.168.25.10. Why will this connection fail?",options:["This is a link-local address.","This is a private IP address.","There is an IP address conflict.","This is a loopback address."],correctIndex:1,explanation:"The IP address 192.168.25.10 is a <strong>private IP address</strong>. This address will not be routed over the Internet."},
            {id:512,module:"5",question:"Refer to the exhibit. An organization is using static NAT to translate the private IP address of Host A to a single public IP address leased from the ISP. Which address is the inside global address of Host A?",image:"images/q512_static_nat.png",options:["209.165.202.129","203.0.113.2","192.168.2.253","192.168.1.1","192.168.1.10"],correctIndex:0,explanation:"The <strong>Inside Global</strong> address is the public IP that the outside world sees representing Host A. Looking at the NAT router, the .129 address (209.165.202.129) on the NAT interface facing the ISP is the translated public address."},
            {id:513,module:"5",question:"Consider the following routing table entry for R1: D 10.1.1.0/24 [90/2170112] via 209.165.200.226, 00:00:05, Serial0/0/0. What is the significance of the Serial0/0/0?",options:["It is the interface on the final destination router that is directly connected to the 10.1.1.0/24 network.","It is the R1 interface through which the EIGRP update was learned.","It is the interface on the next-hop router when the destination IP address the 10.1.1.0/24 network.","It is the interface on R1 used to send data that is destined for 10.1.1.0/24."],correctIndex:3,explanation:"The Serial0/0/0 indicates the <strong>outgoing interface on R1</strong> that is used to send packets for the 10.1.1.0/24 destination network."},
            {id:514,module:"5",question:"A device has an IPv6 address listed as 2001:0DB8:75a3:0214:0607:1234:aa10:ba01. What is the interface ID of the device?",options:["2001:0DB8:75a3","ba01","0607:1234:aa10:ba01","2001:0DB8"],correctIndex:2,explanation:"An IPv6 address comprises 128 bits. The <strong>last four blocks</strong> (64 bits) represent the interface ID: 0607:1234:aa10:ba01."},
            {id:515,module:"5",question:"In what two situations would UDP be the preferred transport protocol over TCP? (Choose two.)",options:["when applications need to guarantee that a packet arrives intact, in sequence, and unduplicated","when a faster delivery mechanism is needed","when delivery overhead is not an issue","when applications do not need to guarantee delivery of the data","when destination port numbers are dynamic"],correctIndices:[1,3],type:"multi",explanation:"UDP is a stateless protocol used for applications that need speedy (best-effort) delivery, like voice/video, and <strong>do not need to guarantee delivery</strong>."},
            {id:516,module:"5",question:"Refer to the exhibit. A computer that is configured with the IPv4 address as shown in the exhibit is unable to access the internet. What is the problem?",image:"images/q516_ipv4_config.png",options:["The gateway address is in the wrong subnet.","The IP address is a network address.","The settings were not validated.","The IP address is a broadcast address."],correctIndex:0,explanation:"The exhibit shows: IP: 192.168.44.150, Subnet: 255.255.255.224 (/27), Gateway: 192.168.44.161. The /27 subnet containing .150 has a range of .129-.158. The gateway .161 is in a different subnet (.160-.190 range), so <strong>the gateway is in the wrong subnet</strong>."},
            {id:517,module:"5",question:"Match the Layer 2 frame field names to the correctly ordered locations for an Ethernet frame. Fields should be ordered from the beginning of the Ethernet frame to the end.",type:"matching",matchData:{leftItems:["First Field","Second Field","Third Field","Fourth Field","Fifth Field","Sixth Field","Seventh Field"],rightItems:["Preamble","SFD","Destination Address","Source Address","EtherType","Data","FCS"],correctPairs:{"First Field":"Preamble","Second Field":"SFD","Third Field":"Destination Address","Fourth Field":"Source Address","Fifth Field":"EtherType","Sixth Field":"Data","Seventh Field":"FCS"}},explanation:"The Ethernet frame fields in order: <strong>1st: Preamble, 2nd: SFD, 3rd: Destination Address, 4th: Source Address, 5th: EtherType, 6th: Data, 7th: FCS</strong>."},
            {id:518,module:"5",question:"What IPv4-related DNS record type is used by a DNS server in response to a host requesting for a web server address via the URL?",options:["AAAA record","NS record","A record","MX record"],correctIndex:2,explanation:"A DNS server uses an <strong>A record</strong> type for an IPv4 end device address. AAAA is for IPv6."},
            {id:519,module:"5",question:"In what two situations would UDP be better than TCP as the preferred transport protocol? (Choose two.)",options:["when applications need to guarantee that a packet arrives intact, in sequence, and unduplicated","when a faster delivery mechanism is needed","when delivery overhead is not an issue","when applications do not need to guarantee delivery of the data","when destination port numbers are dynamic"],correctIndices:[1,3],type:"multi",explanation:"UDP is a simple transport protocol that does not guarantee delivery. Used for applications needing <strong>speedy, best-effort delivery</strong>."},

            // ========== MODULE 6: Application Deployment and Security (15 Questions) ==========
            {id:601,module:"6",question:"Which technique is used to help mitigate SQL injection attacks?",options:["using the same owner or admin account in the web applications to connect to the database","limiting the read access to specific fields of a table or joins of tables","using stored procedures with the 'db_owner' default role","assigning DBA or admin access rights to the application account"],correctIndex:1,explanation:"Mitigation involves <strong>limiting access rights</strong> (least privilege) and <strong>sanitizing/validating inputs</strong>."},
            {id:602,module:"6",question:"Which security device is used to make responses to client requests look like they all come from the same server?",options:["stateful firewall","forward proxy","reverse proxy","jump box"],correctIndex:2,explanation:"A <strong>Reverse Proxy</strong> sits in front of servers and makes responses look like they come from the same server."},
            {id:603,module:"6",question:"What is a characteristic of a virtual machine running on a PC?",options:["A virtual machine needs a physical network adapter to connect to the Internet.","A virtual machine runs its own operating system.","The number of virtual machines that can be made available depends on the software resources of the host machine.","A virtual machine is not susceptible to threats and malicious attacks."],correctIndex:1,explanation:"Each virtual machine <strong>runs its own operating system</strong> (Guest OS) on top of the hypervisor."},
            {id:604,module:"6",question:"What is a characteristic of the blue-green upgrade deployment strategy?",options:["A new environment is created with the new code in it, while the old environment is held in reserve in case users experience problems.","The code changes are periodically rolled out in such a way that they do not impact current users.","The new code is deployed all at once to the old environment.","The new code version is first rolled out to a subset of users."],correctIndex:0,explanation:"<strong>Blue-Green</strong> deployment creates a new environment with new code while keeping old environment in reserve for rollback."},
            {id:605,module:"6",question:"Match the cloud model to its description. (Not all options are used.)",type:"matching",matchData:{leftItems:["Public","Private","Hybrid","Edge"],rightItems:["These are clouds that locate computing as close as possible to the user.","These clouds are made up of two or more clouds. However, each part remains a distinctive and separate object. Both of these are connected using a single architecture.","These are clouds that are intended for a specific organization or entity, such as the government. They can be set up using the private network of an organization."],correctPairs:{"Edge":"These are clouds that locate computing as close as possible to the user.","Hybrid":"These clouds are made up of two or more clouds. However, each part remains a distinctive and separate object. Both of these are connected using a single architecture.","Private":"These are clouds that are intended for a specific organization or entity, such as the government. They can be set up using the private network of an organization."}},explanation:"<strong>Edge</strong>: Computing close to user. <strong>Hybrid</strong>: Two or more clouds connected. <strong>Private</strong>: For specific organization. (Public is not used.)"},
            {id:606,module:"6",question:"Which mitigation method is effective against cross-site scripting?",options:["requiring multifactor authentication","consistent hardening of systems and applications","sanitizing untrusted content","using only necessary features and secure packages downloaded from official sources and verified with a signature"],correctIndex:2,explanation:"<strong>Sanitizing untrusted content</strong> prevents the browser from interpreting user input as executable script code."},
            {id:607,module:"6",question:"Match the environments in the four-tier development environment structure to the description.",type:"matching",matchData:{leftItems:["Development","Testing","Staging","Production"],rightItems:["Where coding takes place","Includes automated tools such as Jenkins, CircleCI, or Travis CI, and is often integrated with a version control system","Structurally as close to the actual production environment as possible","Contains code that has been tested multiple times and is error free"],correctPairs:{"Development":"Where coding takes place","Testing":"Includes automated tools such as Jenkins, CircleCI, or Travis CI, and is often integrated with a version control system","Staging":"Structurally as close to the actual production environment as possible","Production":"Contains code that has been tested multiple times and is error free"}},explanation:"Four-tier: <strong>Development</strong> (coding) ‚Üí <strong>Testing</strong> (automated tools) ‚Üí <strong>Staging</strong> (mirror of production) ‚Üí <strong>Production</strong> (error-free code)."},
            {id:608,module:"6",question:"Which attack involves the insertion of malicious code into SQL statements?",options:["SQL injection","cross-site scripting","brute force","local file inclusion"],correctIndex:0,explanation:"<strong>SQL injection</strong> occurs when malicious SQL statements are inserted into entry fields for execution."},
            {id:609,module:"6",question:"In software development, what is the purpose of a jump box?",options:["to act as a single trusted machine used to launch connections to sensitive systems","to make all requests originating from within a network look like they come from the same source IP address","to filter packets based on Layer 3 and Layer 4 addressing","to receive incoming requests and forward them to multiple servers"],correctIndex:0,explanation:"A <strong>Jump Box</strong> is a hardened server used as a single point of entry to access and manage devices in a secure zone."},
            {id:610,module:"6",question:"Which characters are used to separate batched SQL statements?",options:["semicolons ;","colons :","parentheses ()","pound signs #"],correctIndex:0,explanation:"The <strong>semicolon (;)</strong> is the standard character to terminate and separate SQL statements."},
            {id:611,module:"6",question:"What is a philosophy for software deployment used in the field of DevOps?",options:["OWASP","DevNet","SOAP","CI/CD"],correctIndex:3,explanation:"<strong>CI/CD</strong> (Continuous Integration/Continuous Delivery) is a core DevOps philosophy."},
            {id:612,module:"6",question:"Which statement is a characteristic of the broken access control threat to web applications?",options:["It allows attackers to access, and potentially change, serialized versions of data and objects.","It allows an attacker to use the dynamic functions of a site to inject malicious content into the page.","It allows users to circumvent existing authentication requirements.","It allows attackers to steal sensitive information such as passwords or personal information."],correctIndex:2,explanation:"<strong>Broken access control</strong> occurs when developers build applications that enable users to circumvent existing authentication requirements."},
            {id:613,module:"6",question:"Which technology is used to containerize applications and allows them to run in a variety of environments?",options:["Docker","GitHub","VirtualBox","Cisco DNA"],correctIndex:0,explanation:"<strong>Docker</strong> is the leading platform for containerization, allowing apps to run in any environment."},
            {id:614,module:"6",question:"Match the OWASP resource with a description.",type:"matching",matchData:{leftItems:["Dependency Check","ModSecurity Core Rule Set","Cheat Sheet Series","DefectDojo"],rightItems:["Looks for known vulnerabilities in code","Generic attack detection rules used with web application firewalls","Explains ways to mitigate command security issues in web applications","Streamlines the code testing process"],correctPairs:{"Dependency Check":"Looks for known vulnerabilities in code","ModSecurity Core Rule Set":"Generic attack detection rules used with web application firewalls","Cheat Sheet Series":"Explains ways to mitigate command security issues in web applications","DefectDojo":"Streamlines the code testing process"}},explanation:"<strong>Dependency Check</strong>: Finds vulnerabilities. <strong>ModSecurity</strong>: WAF rules. <strong>Cheat Sheet Series</strong>: Security mitigation guides. <strong>DefectDojo</strong>: Testing process management."},
            {id:615,module:"6",question:"What is used to isolate the different parts of a running container?",options:["wrappers","namespaces","control groups","union file systems"],correctIndex:1,explanation:"Containers use <strong>namespaces</strong> to provide isolation for processes, networking, and other system resources."},

            // ========== MODULE 7: Infrastructure and Automation (16 Questions) ==========
            {id:701,module:"7",question:"What is the most common cause of IT outages?",options:["a threat actor targeting the enterprise equipment","an experienced engineer implementing a configuration using automation","an engineer misconfiguring a device or network with manual changes","an experienced engineer using an open source product"],correctIndex:2,explanation:"Most outages are caused by <strong>human error</strong> when engineers manually misconfigure devices or networks."},
            {id:702,module:"7",question:"What is an unopinionated component in a software ecosystem?",options:["a component that does not show an increased preference for specific companion components or architectures unless those components or architectures are necessary","a component that is classified as open source and does not require the implementation of specific vendor products","a component that may function in a limited ability in order to compensate for the selection of companion components or architectures","a component that requires a specific companion component in order to provide full stack implementation"],correctIndex:0,explanation:"Unopinionated software gives the developer <strong>freedom of choice</strong> regarding architecture and tools."},
            {id:703,module:"7",question:"In the use of container technologies, what is a function of platform abstraction when considering the deployment of a product in a cloud environment?",options:["Traditional complementary software components such as a database server and web server would be implemented as a single containerized application.","Applications require re-engineering in order to implement scalability and consolidation.","A containerized app can run on a generically-specified host environment.","Applications are aware of underlying hardware configurations and are customized to provide increased functionality."],correctIndex:2,explanation:"Platform abstraction allows containerized apps to run on a <strong>generic host environment</strong> without worrying about hardware."},
            {id:704,module:"7",question:"A student is setting up VMs in VirtualBox. The student starts both VMs and tries to verify communications by entering https://192.168.56.101 in a browser. An error message displays 'The connection has timed out'. How can the student verify the IP address assigned by DHCP to the CSR1000v virtual router?",options:["Issue the ping 192.168.56.101 command on the local computer.","Issue the show ip interface brief command in the CSR1000v VM.","Issue the show running-config command in the CSR1000v VM.","Issue the ifconfig command in the CSR1000v VM."],correctIndex:1,explanation:"The command <strong>show ip interface brief</strong> can be used to verify the actual IP address assigned to the interface."},
            {id:705,module:"7",question:"What is the historical correlation between software developers and IT operations?",options:["Developers had the job of creating applications. Operations had the job of verifying that these applications work for users.","Operations had the job of brainstorming applications. Developers had the job of testing that these applications work for users and the business.","Operations had the job of testing applications. Developers had the job of implementing these applications for clients.","Developers had the job of testing applications. Operations had the job of implementing these applications for clients."],correctIndex:0,explanation:"Historically, developers created applications while IT operations ensured they <strong>work for users and the business</strong>."},
            {id:706,module:"7",question:"How is an error budget calculated in the DevOps/SRE culture?",options:["An error budget is the difference between the SLO and the SLI.","An error budget is the difference between the SLO and 100% availability.","An error budget is the difference between the SLO and the SLA.","An error budget is the difference between the SLA and 100% availability."],correctIndex:1,explanation:"The error budget is the amount of unreliability allowed. It is <strong>100% minus the SLO</strong>."},
            {id:707,module:"7",question:"In reviewing a formalized agreement, what is the purpose of an SLI (Service Level Indicator)?",options:["An SLI is a specific set of steps for slowing releases as errors occur.","An SLI is an easy to complete, external agreement that is set between the organization and the customer.","An SLI is a benchmark metric used to determine and describe SLOs.","An SLI is an agreed-upon number of errors per unit time."],correctIndex:2,explanation:"A <strong>Service Level Indicator (SLI)</strong> is a real-world benchmark metric used to determine Service-Level Objectives (SLOs)."},
            {id:708,module:"7",question:"What is the default shell commonly used on macOS and Linux?",options:["Bash","csh","tcsh","Bourne"],correctIndex:0,explanation:"<strong>Bash</strong> (Bourne Again Shell) is the default shell for most Linux distributions and was the default for macOS."},
            {id:709,module:"7",question:"Which type of automation includes scripting that may be dangerous if the starting state is not completely known and controlled?",options:["stateful","stateless","declarative","procedural"],correctIndex:3,explanation:"<strong>Procedural</strong> automation executes steps blindly. If the system isn't in the expected state, the script may break things."},
            {id:710,module:"7",question:"What is an imperative procedure?",options:["An ordered sequence of commands that is used to reach a specific end state.","A set of commands that require administrator privileges and can only be executed on a local system.","A set of commands that is piped to a remote host and immediately executed.","A set of commands that examines a target and only performs the tasks needed to achieve the desired state."],correctIndex:0,explanation:"Imperative programming defines <strong>how</strong> to achieve a result via an ordered sequence of commands."},
            {id:711,module:"7",question:"Which statement describes the declarative static model?",options:["A declarative model will examine present circumstances and bring real infrastructure into alignment in order to reach a desired state.","A declarative model will execute code that is sequentially task-driven instead of focusing on deployment-specific details.","A declarative model will follow a specific order of sequential steps in order to effect changes on a target system.","A declarative model will subdivide code into top-down sections and condition-driven handlers."],correctIndex:0,explanation:"Declarative models define <strong>what</strong> the end state should be, and the system figures out how to align current state to that desire."},
            {id:712,module:"7",question:"Refer to the exhibit. A user is working on Ansible on the local NMS to manage remote network devices. The user issues the 'ansible webservers -m ping' command. However, an error message returns. What are two possible causes for the error? (Choose two.)",image:"images/q712_ansible_error.png",options:["The SSH credential is wrong.","The destination host IP address is wrong.","The switch -m should be -M","The SSH client is not installed.","The destination host alias is wrong.","The SSH service does not start on the host."],correctIndices:[1,5],type:"multi",explanation:"The error indicates the SSH server on the destination host cannot be reached. Possible issues: <strong>IP address is wrong</strong> or <strong>SSH service is not running</strong>."},
            {id:713,module:"7",question:"Which component in the pyATS ecology handles bundling and running jobs?",options:["EasyPy","AEtest","Genie","Clover"],correctIndex:0,explanation:"<strong>EasyPy</strong> is the runtime engine that can take one or more pyATS scripts and compile them into a job and run them together as a batch."},
            {id:714,module:"7",question:"An engineer has just created a backup file of a Cisco VIRL network simulation. Which command should be used to compare the most recent .virl file with the previous backup file?",options:["diff","pyats","knife","source","list"],correctIndex:0,explanation:"The standard <strong>diff</strong> command is used to compare contents of two files."},
            {id:715,module:"7",question:"While working in the Ansible code structure, which type of file contains a sequence of tasks, executed in top-down order?",options:[".virl",".yml",".py",".txt"],correctIndex:1,explanation:"Ansible playbooks are written in <strong>YAML (.yml)</strong>."},
            {id:716,module:"7",question:"What is a standard command to create a Python virtual environment?",options:["sudo apt-get install python3-pip","pip install [options] [package-index-options]‚Ä¶","python3 -m venv /path/to/new/virtual/environment","source bin/activate"],correctIndex:2,explanation:"The <strong>venv</strong> command is used to create lightweight virtual environments: python3 -m venv /path/to/env."},

            // ========== MODULE 8: Cisco Platforms and Development (15 Questions) ==========
            {id:801,module:"8",question:"Which underlying technology makes it possible for Cisco Umbrella to prevent a user from accessing a blocked site?",options:["DNS","HTTP and HTTPS","Cisco Firewall","DHCP"],correctIndex:0,explanation:"Cisco Umbrella uses <strong>DNS</strong> to block access to malicious domains, URLs, IPs, and files before a connection is established."},
            {id:802,module:"8",question:"Which language is used by the NETCONF protocol to encode both the configuration data and protocol messages?",options:["XML","YAML","HTML","JSON"],correctIndex:0,explanation:"NETCONF uses <strong>XML</strong> for data encoding."},
            {id:803,module:"8",question:"What are the three main capabilities provided by Cisco AMP? (Choose three.)",options:["annihilation","detection","responses and automation","redirection","relaying","prevention"],correctIndices:[1,2,5],type:"multi",explanation:"Cisco AMP provides <strong>Prevention, Detection, and Responses/Automation</strong>."},
            {id:804,module:"8",question:"Which three functions are provided by Cisco Finesse REST APIs? (Choose three.)",options:["They can be used to integrate into existing applications to add contact center functionality.","They can be used to get termination call detail (TCD) reports.","They can be used to get the call history of an agent.","They can be used to build a fully functioning agent desktop.","They can be used to build custom OpenSocial gadgets.","They can be used to build a script to automate tasks."],correctIndices:[0,3,5],type:"multi",explanation:"Finesse REST APIs can build a <strong>fully functioning agent desktop</strong>, <strong>integrate into existing apps</strong>, and <strong>automate tasks</strong>."},
            {id:805,module:"8",question:"Which two benefits are provided by the Python-based Webex Teams SDK? (Choose two.)",options:["It integrates with the Webex Devices API.","It provides error reporting.","It provides access to more API calls within Webex Teams.","It manages requests with pagination.","It is better supported than the Webex Teams APIs."],correctIndices:[1,3],type:"multi",explanation:"The SDK provides <strong>error reporting</strong> and <strong>manages pagination</strong> automatically."},
            {id:806,module:"8",question:"Refer to the exhibit. Which data format is used to describe the list of interfaces?",image:"images/q806_yang_format.png",options:["JSON","YANG","XML","YAML"],correctIndex:1,explanation:"<strong>YANG</strong> models use a tree structure. The format shown is the YANG tree/module structure."},
            {id:807,module:"8",question:"Which two statements describe the usage of Cisco Finesse JavaScript APIs? (Choose two.)",options:["They can be used to get the call history of an agent.","They can be used to build custom gadgets to be placed into applications other than Finesse.","They can be used to embed existing web pages into a custom gadget.","They can be used to build a custom gadget for the agent state workflow.","They can be used to build a fully functioning agent desktop."],correctIndices:[2,3],type:"multi",explanation:"Finesse JavaScript APIs can <strong>embed existing web pages</strong> into gadgets and <strong>build custom agent state workflow gadgets</strong>."},
            {id:808,module:"8",question:"Why does the Meraki dashboard API return a 404 rather than a 403 code in response to a request with an invalid API key?",options:["The 404 return code determines whether unauthorized users will try again.","The 403 return code would indicate that the client definitely has an invalid API key.","The 404 return code prevents the system from indicating the existence of resources to unauthorized users.","The 403 return code would indicate that there are no resources at that endpoint but the API key could be correct."],correctIndex:2,explanation:"Returning <strong>404</strong> instead of 403 prevents attackers from knowing if a resource exists at that endpoint."},
            {id:809,module:"8",question:"What does Cisco ISE do when it identifies a user or device accessing the network?",options:["It logs the access attempt.","It automatically and securely places the device and user into the right part of the network.","It processes the originating IP address according to a whitelist.","It quarantines the device and user until an administrator releases the quarantine."],correctIndex:1,explanation:"Cisco ISE identifies devices and <strong>securely places them into the correct network segment</strong> based on policy."},
            {id:810,module:"8",question:"How are service profiles used by Cisco UCS Manager?",options:["Cisco UCS Manager uses an assigned service profile to each instance to define network policy.","Cisco UCS Manager uses service profiles to assign a unique identity to the server associated with each profile.","Cisco UCS Manager saves service profiles to recover servers in case of data loss.","Cisco UCS Manager uses service profiles as templates to provision policies to multiple versions of the same server."],correctIndex:1,explanation:"Service profiles <strong>assign a unique identity</strong> (UUID, MAC, WWN) to a server."},
            {id:811,module:"8",question:"Which function does the AXL interface provide for users?",options:["provisions and manages objects in the Unified Communication Management Administration Console","looks up the top ten OWASP vulnerabilities and identifies which endpoints are vulnerable","updates network device configurations with a rollback mechanism","provisions Webex Devices and customizes each display"],correctIndex:0,explanation:"AXL is used to <strong>provision and manage objects</strong> in the Cisco Unified Communications Manager database."},
            {id:812,module:"8",question:"What are three primary YANG sources in Cisco NSO? (Choose three.)",options:["mapping model","data models from devices","NSO data model","configuration models","communication model","YANG service models"],correctIndices:[1,2,5],type:"multi",explanation:"NSO uses <strong>NSO data model</strong>, <strong>Device data models</strong> (NEDs), and <strong>YANG service models</strong>."},
            {id:813,module:"8",question:"What are two tasks a network administrator can perform with Cisco UCS Director? (Choose two.)",options:["Manage multiple Cisco UCS Manager appliances.","Deploy and add capacity to converged infrastructures in a consistent and repeatable manner.","Load-balance data traffic.","Create, clone, and deploy service profiles and templates for all Cisco UCS servers and compute applications.","Create a direct line of communication between Cisco and non-Cisco components."],correctIndices:[1,3],type:"multi",explanation:"UCS Director can <strong>deploy/add capacity consistently</strong> and <strong>create/clone/deploy service profiles</strong>."},
            {id:814,module:"8",question:"What are two actions taken by Firepower for traffic control? (Choose two.)",options:["using security intelligence data to filter traffic, including IP addresses, address blocks, domain names, and URLs","controlling which websites are available to the users on the network","shutting down the network in the event of a DDOS attack","directing heavy data traffic to free servers","load balancing during high-traffic time periods"],correctIndices:[0,1],type:"multi",explanation:"Firepower uses <strong>security intelligence to filter traffic</strong> and <strong>controls which websites are available</strong>."},
            {id:815,module:"8",question:"What are two types of YANG models? (Choose two.)",options:["native model","vendor model","private model","hybrid model","open model"],correctIndices:[0,4],type:"multi",explanation:"Two types: <strong>Native</strong> (vendor-specific like Cisco) and <strong>Open</strong> (standardized like IETF, OpenConfig)."}
        ];
        
        // ========== FINAL EXAM QUESTIONS (Modules 5-8 Only) ==========
        const finalExamData = [
            // Module 5: Network Fundamentals
            {id:901,module:"5",question:"Data is being sent from a source PC to a destination server. Which three statements correctly describe the function of TCP or UDP? (Choose three.)",options:["The TCP process running on the PC randomly selects the destination port when establishing a session with the server.","UDP segments are encapsulated within IP packets for transport across the network.","The TCP source port number identifies the sending host on the network.","The UDP destination port number identifies the application or service on the server which will handle the data.","The source port field identifies the running application or service that will handle data returning to the PC.","TCP is the preferred protocol when a function requires lower network overhead."],correctIndices:[1,3,4],type:"multi",explanation:"Layer 4 port numbers identify the application or service. <strong>UDP segments are encapsulated in IP packets</strong>, <strong>destination port identifies the service</strong>, and <strong>source port handles return data</strong>."},
            {id:902,module:"5",question:"Which command can be used on Linux and MAC hosts to get IP addressing information?",options:["ipconfig","ip address","ifconfig","networksetup -getinfo"],correctIndex:2,explanation:"<strong>ifconfig</strong> is used on Linux and Mac hosts. ipconfig is for Windows."},
            {id:903,module:"5",question:"What are two reasons a network administrator would segment a network with a Layer 2 switch? (Choose two.)",options:["to create fewer collision domains","to create more broadcast domains","to enhance user bandwidth","to isolate ARP request messages from the rest of the network","to eliminate virtual circuits","to isolate traffic between segments"],correctIndices:[2,5],type:"multi",explanation:"Switches <strong>enhance user bandwidth</strong> by creating temporary point-to-point connections and <strong>isolate traffic between segments</strong>."},
            {id:904,module:"5",question:"A network contains multiple VLANs spanning multiple switches. What happens when a device in VLAN 20 sends a broadcast Ethernet frame?",options:["Devices in VLAN 20 and the management VLAN see the frame.","All devices in all VLANs see the frame.","Only devices that are connected to the local switch see the frame.","Only devices in VLAN 20 see the frame."],correctIndex:3,explanation:"<strong>VLANs create logical broadcast domains</strong>. Broadcasts only reach devices in the same VLAN."},
            {id:905,module:"5",question:"How is an Ethernet MAC address constructed?",options:["The first 3 bytes represent the network, and the last 3 bytes uniquely identify the host.","The first 3 bytes represent the vendor OUI, and the last 3 bytes are assigned uniquely by the vendor.","The first 3 bytes are uniquely assigned by IANA, and the last 3 bytes represent the serial number.","The first 3 bytes represent the vendor OUI, and the last 3 bytes are assigned randomly by the OS."],correctIndex:1,explanation:"MAC: <strong>First 3 bytes = OUI (vendor)</strong>, <strong>Last 3 bytes = unique assignment by vendor</strong>."},
            {id:906,module:"5",question:"A packet is received by a server. The packet has a destination port number of 443. What protocol or service is requested?",options:["HTTP","NTP","DHCP","HTTPS"],correctIndex:3,explanation:"Port 443 = <strong>HTTPS</strong> (HTTP Secure)."},
            {id:907,module:"5",question:"When thinking about the functional planes of a network, what is unique about the data plane?",options:["It includes protocols used to remotely access network devices.","It includes the SSH protocol.","It manipulates data and outputs it in the XML format.","It forwards data through a network infrastructure device."],correctIndex:3,explanation:"The <strong>data plane forwards packets</strong> through the network infrastructure in hardware."},
            {id:908,module:"5",question:"A packet is received by a server. The packet has a destination port number of 53. What protocol or service is requested?",options:["DNS","NetBIOS","POP3","IMAP"],correctIndex:0,explanation:"Port 53 = <strong>DNS</strong> (Domain Name System)."},
            {id:909,module:"5",question:"Which statement accurately describes dynamic NAT?",options:["It always maps a private IP address to a public IP address.","It provides an automated mapping of inside local to inside global IP addresses.","It provides a mapping of internal host names to IP addresses.","It dynamically provides IP addressing to internal hosts."],correctIndex:1,explanation:"<strong>Dynamic NAT</strong> provides automated mapping of inside local to inside global IP addresses."},
            {id:910,module:"5",question:"A network administrator can successfully ping the server at www.cisco.com, but cannot ping the company web server at an ISP. Which tool would help identify where the packet was lost?",options:["traceroute","ipconfig","telnet","netstat"],correctIndex:0,explanation:"<strong>traceroute</strong> shows the path packets take and identifies where delays or losses occur."},
            
            // Module 6: Application Deployment & Security
            {id:911,module:"6",question:"A pharmaceutical company wants to contract cloud services with strict access security for employee data. Which type of cloud would be most appropriate?",options:["community cloud","public cloud","hybrid cloud","private cloud"],correctIndex:3,explanation:"<strong>Private cloud</strong> offers strict access security for sensitive organizational data."},
            {id:912,module:"6",question:"What type of attack targets an SQL database using the input field of a user?",options:["buffer overflow","SQL injection","Cross site scripting","XML injection"],correctIndex:1,explanation:"<strong>SQL injection</strong> inserts malicious SQL statements through user input fields."},
            {id:913,module:"6",question:"Which tool might a developer use as part of a Continuous Integration pipeline to build and test source code?",options:["SQL","REST","Docker","Jenkins"],correctIndex:3,explanation:"<strong>Jenkins</strong>, CircleCI, and Travis CI are automated testing tools for CI/CD pipelines."},
            {id:914,module:"6",question:"Which piece of software creates and manages virtual machines, allocating system resources as needed?",options:["supervisor","hypervisor","host operating system","hosted operating system"],correctIndex:1,explanation:"<strong>Hypervisor</strong> creates and manages VMs and allocates resources to each."},
            {id:915,module:"6",question:"A network engineer is creating a Docker container. If no tag is specified, which tag will be used by default?",options:["tag","latest","(a blank space)","default"],correctIndex:1,explanation:"If no tag is specified, Docker uses <strong>latest</strong> by default."},
            {id:916,module:"6",question:"What is immutable infrastructure in DevOps?",options:["infrastructure deployed with versions locked except for manual changes","infrastructure only deployed in containers","infrastructure entirely maintained in code and never manually changed","virtualized infrastructure deployed as golden images"],correctIndex:2,explanation:"<strong>Immutable infrastructure</strong> is entirely maintained through code and never subjected to manual changes."},
            {id:917,module:"6",question:"What is the most common cause of IT outages?",options:["an engineer misconfiguring a device with manual changes","an experienced engineer using an open source product","an experienced engineer implementing automation","a threat actor targeting enterprise equipment"],correctIndex:0,explanation:"Most outages are caused by <strong>manual misconfiguration due to human error</strong>."},
            {id:918,module:"6",question:"Which Docker component defines the steps needed to create an image?",options:["UnionFS","Dockerfile","cross-site script","namespaces"],correctIndex:1,explanation:"<strong>Dockerfile</strong> defines the steps to build a Docker image."},
            {id:919,module:"6",question:"Which three statements describe characteristics of a virtual machine? (Choose three.)",options:["It is created using the Docker format.","It includes a guest operating system.","It runs on top of a hypervisor.","It shares the OS of the host.","It is self-contained with emulated storage, memory, and network.","It requires Windows as host OS."],correctIndices:[1,2,4],type:"multi",explanation:"VMs <strong>include a guest OS</strong>, <strong>run on a hypervisor</strong>, and are <strong>self-contained</strong>."},
            {id:920,module:"6",question:"What are two characteristics of the staging environment? (Choose two.)",options:["Code has been tested multiple times and is error free.","It is structured as close as possible to production.","It is where code undergoes final acceptance testing.","It is where end users will interact with the code.","It often includes automated testing tools like Jenkins."],correctIndices:[1,2],type:"multi",explanation:"Staging is <strong>close to production</strong> and where <strong>final acceptance testing</strong> occurs."},
            {id:921,module:"6",question:"Which technique makes the output of password hashing nondeterministic?",options:["password length and complexity","multifactor authentication","password salting","password strength validation tools"],correctIndex:2,explanation:"<strong>Password salting</strong> adds random data to make hashes nondeterministic."},
            {id:922,module:"6",question:"Which SQL injection defense should be used only as a last resort?",options:["escaping all user-supplied input","using a database firewall","implementing whitelist input validation","using parameterized queries"],correctIndex:0,explanation:"<strong>Escaping all user-supplied input</strong> is a last resort; parameterized queries are preferred."},
            
            // Module 7: Infrastructure & Automation
            {id:923,module:"7",question:"What is a function of a read-only automation solution?",options:["reduce risk by implementing security policies via automated changes","use GET and SET requests to retrieve and send data","audit configurations and manually deploy changes for compliance","implement infrastructure that receives config from a centralized server"],correctIndex:2,explanation:"Read-only automation can <strong>audit configurations</strong> and do the next natural step to put config back into compliance."},
            {id:924,module:"7",question:"In Ansible, which file contains device information used by playbooks?",options:["service","playbook","variable","hosts"],correctIndex:3,explanation:"<strong>hosts</strong> is the inventory file containing device information for Ansible playbooks."},
            {id:925,module:"7",question:"Which component in the pyATS ecology handles bundling and running jobs?",options:["AEtest","Clover","Genie","EasyPy"],correctIndex:3,explanation:"<strong>EasyPy</strong> is the runtime engine that bundles and runs pyATS jobs."},
            {id:926,module:"7",question:"Which string identifies the beginning of a new document in a YAML file with multiple documents?",options:["three slashes ///","three dots ...","three pound signs ###","three dashes ---"],correctIndex:3,explanation:"<strong>Three dashes (---)</strong> separate documents in YAML files."},
            {id:927,module:"7",question:"What is the difference between functions and methods in Python?",options:["Functions use global variables; methods use only local variables.","Functions are called by referencing object; methods are called by names.","Functions can pass arguments; methods can only pass keywords.","Functions are standalone; methods are associated with an object."],correctIndex:3,explanation:"<strong>Functions are standalone</strong>; <strong>methods are associated with an object</strong> (OOP)."},
            {id:928,module:"7",question:"Which command is used to create a new Git repository?",options:["git init","git add","git commit","git clone"],correctIndex:0,explanation:"<strong>git init</strong> initializes a new Git repository."},
            {id:929,module:"7",question:"What character separates key and value pairs in YAML?",options:["colon :","semi colon ;","underscore _","forward slash /"],correctIndex:0,explanation:"<strong>Colon (:)</strong> separates keys from values in YAML."},
            {id:930,module:"7",question:"Which git command compares changes between files?",options:["git diff","git merge","git checkout","git status"],correctIndex:0,explanation:"<strong>git diff</strong> shows differences between files or commits."},
            {id:931,module:"7",question:"What does orchestration refer to in IT automation?",options:["Managing workload lifecycles and reacting to changing conditions","Preparing a server through installation of libraries","Building and arranging multi-component applications","Obtaining compute, storage, and network infrastructure"],correctIndex:0,explanation:"Orchestration <strong>manages workload lifecycles</strong> and reacts dynamically to conditions (e.g., autoscaling)."},
            {id:932,module:"7",question:"Which communication protocol does Ansible use to connect to remote devices?",options:["Telnet over VPN","HTTPS","Secure FTP","SSH"],correctIndex:3,explanation:"Ansible uses <strong>SSH</strong> to communicate with remote machines."},
            {id:933,module:"7",question:"A developer issues 'python3 -m venv devenv'. What is the developer trying to achieve?",options:["install devnet tools in the venv named Python 3","create a Python 3 virtual environment named devenv","activate the Python 3 virtual environment named devenv","enter the Python 3 venv named venv using devnet tools"],correctIndex:1,explanation:"<strong>python3 -m venv devenv</strong> creates a virtual environment named devenv."},
            
            // Module 8: Cisco Platforms
            {id:934,module:"8",question:"A packet has destination port 8008. What protocol or service is requested?",options:["Telnet over SSH","RESTCONF","HTTP","NETCONF"],correctIndex:2,explanation:"Port 8008 is commonly used for <strong>HTTP</strong> (alternate HTTP port)."},
            {id:935,module:"8",question:"Which Cisco SDK works with ACI?",options:["Cobra","IMC","UCS","Instant Connect"],correctIndex:0,explanation:"<strong>Cobra</strong> is the Python SDK for Cisco ACI."},
            {id:936,module:"8",question:"Which two data formats can RESTCONF use? (Choose two.)",options:["JSON","XML","YAML","YANG","HTML"],correctIndices:[0,1],type:"multi",explanation:"RESTCONF can use <strong>JSON</strong> or <strong>XML</strong> for data encoding."},
            {id:937,module:"8",question:"Which library is most commonly used for Python NETCONF clients?",options:["posix","pyclient","ncclient","pypi"],correctIndex:2,explanation:"<strong>ncclient</strong> is the most common Python library for NETCONF."},
            {id:938,module:"8",question:"Which two Meraki APIs allow device provisioning and real-time notifications? (Choose two.)",options:["Webhook API","Investigation API","Dashboard API","Enforcement API","Reporting API"],correctIndices:[0,2],type:"multi",explanation:"<strong>Dashboard API</strong> for provisioning/management, <strong>Webhook API</strong> for real-time notifications."},
            {id:939,module:"8",question:"A packet has destination port 830. What protocol or service is requested?",options:["NTP","DHCP","NETCONF","HTTPS"],correctIndex:2,explanation:"Port 830 = <strong>NETCONF</strong> (default port using SSH transport)."},
            {id:940,module:"8",question:"Which programming language is supported by Webex xAPI for macros?",options:["Java","Python","JavaScript","C++"],correctIndex:2,explanation:"<strong>JavaScript</strong> is used to develop macros for Webex devices."},
            {id:941,module:"8",question:"Which Cisco management system is designed for SDN and runs on Nexus 9000 hardware?",options:["Application Centric Infrastructure (ACI)","IOS XE","Nexus Operating System (NX-OS)","DNA Center"],correctIndex:0,explanation:"<strong>ACI</strong> is Cisco's SDN solution running on Nexus 9000."},
            {id:942,module:"8",question:"What is an architectural constraint of a true RESTful API?",options:["It must support XML-RPC and JSON-RPC.","It allows resource caching.","It should be behind a firewall.","It operates as a cloud service."],correctIndex:1,explanation:"REST constraints include Client/Server, Stateless, <strong>Cache</strong>, Uniform interface, Layered system, Code on demand."},
            {id:943,module:"8",question:"Which Cisco product provides a rule-based engine for policy-based network access?",options:["Identity Services Engine","Umbrella","Threat Grid","Advanced Malware Protection"],correctIndex:0,explanation:"<strong>ISE</strong> provides policy-based network access through a rule-based engine."},
            {id:944,module:"8",question:"When thinking about the functional planes, what is unique about the management plane?",options:["It forwards data based on STP settings.","It is responsible for switching packets in hardware.","It includes protocols used to monitor network devices.","It includes protocols between network devices like routers."],correctIndex:2,explanation:"<strong>Management plane</strong> manages traffic destined for the device itself (SSH, SNMP)."}
        ];

        // ========== NETACAD QUIZZES (Combined from Official Netacad Sources) ==========
        const netacadQuizData = [
            // ========== MODULE 5: Network Fundamentals Quiz (5.7.2) ==========
            {id:1001,module:"5",question:"Which statement describes the ping and tracert commands?",options:["Tracert shows each hop, while ping shows a destination reply only.","Tracert uses IP addresses; ping does not.","Both ping and tracert can show results in a graphical display.","Ping shows whether the transmission is successful; tracert does not."],correctIndex:0,explanation:"The <strong>ping</strong> utility tests end-to-end connectivity. The <strong>traceroute</strong> utility (tracert in Windows) traces the route and displays each hop along the way."},
            {id:1002,module:"5",question:"Which IPv6 address is most compressed for the full FE80:0:0:0:2AA:FF:FE9A:4CA3 address?",options:["FE80:::0:2AA:FF:FE9A:4CA3","FE8::2AA:FF:FE9A:4CA3","FE80::0:2AA:FF:FE9A:4CA3","FE80::2AA:FF:FE9A:4CA3"],correctIndex:3,explanation:"When compressing IPv6, the <strong>::</strong> can be used to replace a recurring set of 0s only once. <strong>FE80::2AA:FF:FE9A:4CA3</strong> is the most compressed form."},
            {id:1003,module:"5",question:"Which command can be used on Linux and MAC hosts to get IP addressing information?",options:["networksetup -getinfo","ipconfig","ip address","ifconfig"],correctIndex:3,explanation:"<strong>ifconfig</strong> is the command used on Linux and Mac hosts to display IP addressing information. ipconfig is for Windows."},
            {id:1004,module:"5",question:"What type of IPv6 address is FE80::1?",options:["global unicast","loopback","link-local","multicast"],correctIndex:2,explanation:"<strong>Link-local</strong> IPv6 addresses start with FE80::/10 (any address from FE80:: to FEBF::). They allow directly connected devices to communicate."},
            {id:1005,module:"5",question:"Which two statements are true about NTP servers in an enterprise network? (Choose two.)",options:["There can only be one NTP server on an enterprise network.","NTP servers control the mean time between failures (MTBF) for key network devices.","NTP servers at stratum 1 are directly connected to an authoritative time source.","All NTP servers synchronize directly to a stratum 1 time source.","NTP servers ensure an accurate time stamp on logging and debugging information."],correctIndices:[2,4],type:"multi",explanation:"<strong>Stratum 1 devices are directly connected to authoritative time sources</strong>, and <strong>NTP ensures accurate timestamps</strong> for logging and debugging."},
            {id:1006,module:"5",question:"A small-sized company has 30 workstations and 2 servers. The company has been assigned a group of IPv4 addresses 209.165.200.224/29 from its ISP. What technology should the company implement to allow all workstations to access services over the Internet simultaneously?",options:["static NAT","dynamic NAT","DHCP","port address translation"],correctIndex:3,explanation:"With only 6 usable public addresses and 30 workstations, <strong>PAT (Port Address Translation)</strong> or NAT overload must be used to share addresses."},
            {id:1007,module:"5",question:"Which statement describes a stateful firewall?",options:["It can determine if the connection is in the initiation, data transfer, or termination phase.","It can expand the number of IP addresses available and can hide network addressing design.","It can filter packets based on information at Layers 3, 4, 5 and 7 of the OSI reference model.","It can only filter packets based on limited Layer 3 and 4 information."],correctIndex:0,explanation:"A <strong>stateful firewall</strong> tracks the state of connections and can determine if traffic is part of an established session."},
            {id:1008,module:"5",question:"Which impact does adding a Layer 2 switch have on a network?",options:["an increase in the number of dropped frames","an increase in the size of the broadcast domain","an increase in the size of the collision domain","an increase in the number of network collisions"],correctIndex:1,explanation:"Adding a Layer 2 switch <strong>increases the size of the broadcast domain</strong> while increasing the number of collision domains (one per port)."},
            {id:1009,module:"5",question:"Data is being sent from a source PC to a destination server. Which three statements correctly describe the function of TCP or UDP in this situation? (Choose three.)",options:["The source port field identifies the running application or service that will handle data returning to the PC.","The UDP destination port number identifies the application or service on the server which will handle the data.","UDP segments are encapsulated within IP packets for transport across the network.","TCP is the preferred protocol when a function requires lower network overhead.","The TCP source port number identifies the sending host on the network.","The TCP process running on the PC randomly selects the destination port when establishing a session with the server."],correctIndices:[0,1,2],type:"multi",explanation:"<strong>Source port identifies the return app</strong>, <strong>destination port identifies the server service</strong>, and <strong>UDP segments are encapsulated in IP packets</strong>."},
            {id:1010,module:"5",question:"What is the function of the MIB element as part of a network management system?",options:["to send and retrieve network management information","to change configurations on SNMP agents","to store data about a device","to collect data from SNMP agents"],correctIndex:2,explanation:"The <strong>Management Information Base (MIB)</strong> resides on a networking device and <strong>stores operational data about the device</strong>."},
            {id:1011,module:"5",question:"Which two devices allow hosts on different VLANs to communicate with each other? (Choose two.)",options:["Layer 3 switch","hub","Layer 2 switch","repeater","router"],correctIndices:[0,4],type:"multi",explanation:"Members of different VLANs need <strong>Layer 3 devices</strong> (router or Layer 3 switch) to communicate."},
            {id:1012,module:"5",question:"What is obtained when ANDing the address 192.168.65.3/18 with its subnet mask?",options:["192.168.32.0","192.168.64.0","192.168.0.0","192.168.16.0"],correctIndex:1,explanation:"ANDing 192.168.65.3 with /18 mask results in <strong>192.168.64.0</strong>."},

            // ========== MODULE 6: Application Deployment and Security Quiz (6.6.2) ==========
            {id:1101,module:"6",question:"In serverless computing, which term refers to the ability for resources surrounding an app to change and adjust capacity as needed?",options:["extensible","scalable","elastic","flexible"],correctIndex:2,explanation:"<strong>Elastic</strong> refers to the ability of cloud resources to automatically scale up or down based on demand."},
            {id:1102,module:"6",question:"Which Linux-based platform is used to create, run, and manage containers in a virtual environment?",options:["Docker","Hyper-V","KVM","Bash"],correctIndex:0,explanation:"<strong>Docker</strong> is a very popular container engine used to create, run, and manage containers."},
            {id:1103,module:"6",question:"What is Bash?",options:["a Linux script engine that allows commands to be entered on the command line","a code injection technique used to attack data-driven applications","a web application framework written in Python","a philosophy for software deployment that figures prominently in the field of DevOps"],correctIndex:0,explanation:"<strong>Bash</strong> is the name of a Linux script engine that lets users execute commands from the command line."},
            {id:1104,module:"6",question:"Which load balancing technique will check the load status of multiple hosting servers and send the next incoming request to the server with the lowest load?",options:["least connections","IP hash","canary","blue-green"],correctIndex:0,explanation:"<strong>Least connections</strong> method checks server load and sends requests to the server with the lowest load."},
            {id:1105,module:"6",question:"Which web application attack involves an attacker accessing, and potentially changing, serialized versions of data and objects?",options:["broken authentication","insecure deserialization","security misconfiguration","cross-site scripting"],correctIndex:1,explanation:"<strong>Insecure deserialization</strong> attacks occur when attackers access and potentially modify serialized data and objects."},
            {id:1106,module:"6",question:"Which social engineering technique is carried out by someone attempting to gain access to a building by wearing a delivery service uniform?",options:["phishing","impersonation","vishing","smishing"],correctIndex:1,explanation:"<strong>Impersonation</strong> is a social engineering attack where the attacker impersonates a trusted person to gain physical access."},
            {id:1107,module:"6",question:"A company has remote employees who need to connect to the company network in order to participate in meetings and share data. Which data transportation security technique can be implemented?",options:["SSL","SSH","VPN","TLS"],correctIndex:2,explanation:"A <strong>VPN (Virtual Private Network)</strong> securely connects remote workers to the internal network."},
            {id:1108,module:"6",question:"Which two attacks target web servers through exploiting possible vulnerabilities of input functions used by an application? (Choose two.)",options:["port scanning","SQL injection","trust exploitation","cross-site scripting","port redirection"],correctIndices:[1,3],type:"multi",explanation:"<strong>SQL injection</strong> and <strong>cross-site scripting (XSS)</strong> are command injection attacks that exploit input vulnerabilities."},
            {id:1109,module:"6",question:"Which statement describes the term containers in virtualization technology?",options:["a group of VMs with identical OS and applications","a subsection of a virtualization environment that contains one or more VMs","isolated areas of a virtualization environment, where each area is administered by a customer","a virtual area with multiple independent applications sharing the host OS and hardware"],correctIndex:3,explanation:"<strong>Containers</strong> are a virtual area where multiple apps can run independently while <strong>sharing the host OS and hardware</strong>."},
            {id:1110,module:"6",question:"A threat actor has used malicious commands to trick the database into returning unauthorized records and other data. Which web front-end vulnerability is being exploited?",options:["security misconfiguration","broken authentication","SQL injections","cross-site scripting"],correctIndex:2,explanation:"<strong>SQL injection</strong> allows threat actors to control the application database through malicious SQL commands."},
            {id:1111,module:"6",question:"What are three characteristics of a virtual machine? (Choose three.)",options:["It includes a guest OS.","It leverages the kernel of the host OS for quick starts.","It is a virtualized physical server.","It shares the underlying resources of the host OS.","It is an isolated environment for applications.","It requires a hypervisor."],correctIndices:[0,4,5],type:"multi",explanation:"VMs <strong>include a guest OS</strong>, are <strong>isolated environments</strong>, and <strong>require a hypervisor</strong>."},
            {id:1112,module:"6",question:"What is a characteristic of the development environment in the four-tier deployment environment structure?",options:["It is where coding takes place.","It is structurally similar to the final production environment.","It is where users will interact with the code.","It contains code that has been tested and is error free."],correctIndex:0,explanation:"The <strong>development environment</strong> is where coding takes place."},
            {id:1113,module:"6",question:"What is CI/CD?",options:["It is a malicious code injection technique which is used to attack data-driven applications.","It is a web application development framework that is written in Python.","It is a script engine that allows users to execute commands from the command line.","It is a philosophy for software deployment that is often used in the field of DevOps."],correctIndex:3,explanation:"<strong>CI/CD</strong> (Continuous Integration/Continuous Delivery) is a DevOps philosophy for software deployment."},

            // ========== MODULE 7: Automating, Developing, and Deploying Applications Quiz (7.8.2) ==========
            {id:1201,module:"7",question:"What is the average cost per hour of an enterprise outage for the largest enterprises?",options:["$700,000.00 per hour","$500,000.00 per hour","$300,000.00 per hour","$100,000.00 per hour"],correctIndex:2,explanation:"According to Gartner, the <strong>average cost per hour for a large enterprise outage is $300,000</strong>."},
            {id:1202,module:"7",question:"What is idempotency in IT automation?",options:["the quality of software","the reusing of shell commands","the security level of software","the scripting of shell commands"],correctIndex:0,explanation:"<strong>Idempotency</strong> is a recurring theme in automation and refers to the quality of software that produces the same result regardless of how many times it runs."},
            {id:1203,module:"7",question:"A student is creating an Ansible playbook to practice management automation of a Cisco router. Which command should the student add to the playbook to find interface names, assigned IP addresses, and status?",options:["show running-config","show ip interface brief","show ip route","ip address"],correctIndex:1,explanation:"<strong>show ip interface brief</strong> displays interface names, IP addresses, and status."},
            {id:1204,module:"7",question:"When following the best practices and core principles of DevOps, how is failure considered?",options:["Failure is normal.","Failure is simply 'repair work'.","Failure should only occur in Ops.","Failure should not influence software design methodology."],correctIndex:0,explanation:"In DevOps culture, <strong>failure is considered normal</strong> and influences software design methodology."},
            {id:1205,module:"7",question:"What is a canary deployment?",options:["the switchover of selected users to a new release deployment","a production test using a chaos tool to inject random failures with a limited blast-radius","a server-by-server switchover to a new release deployment","the use of two identical servers with load balancers to redirect traffic for an entire server as needed"],correctIndex:0,explanation:"<strong>Canary deployment</strong> deploys to a small fraction of users first to reduce risk and improve feedback quality."},
            {id:1206,module:"7",question:"What are two challenges of cloud computing technologies? (Choose two.)",options:["utilizing generic host environments","maintaining access control","maintaining configurational consistency of platforms","managing costs","requesting additional resources"],correctIndices:[1,3],type:"multi",explanation:"Challenges include <strong>maintaining access control</strong> and <strong>managing costs</strong> in cloud environments."},
            {id:1207,module:"7",question:"Which technology can run on bare metal or on large virtual machines to simulate Cisco networks and utilities?",options:["Git","VIRL","Puppet","Ansible"],correctIndex:1,explanation:"<strong>Cisco VIRL</strong> is ideal for learning and simulating networks on bare metal or VMs."},
            {id:1208,module:"7",question:"An analyst is using Ansible to perform remote management tasks on network devices. Which file type in the Ansible file structure describes the devices under management?",options:["role folders and files","variable file","inventory file","playbook file"],correctIndex:2,explanation:"The <strong>inventory file</strong> (also called hosts file) contains device information used by Ansible playbooks."},
            {id:1209,module:"7",question:"What is an error budget in the DevOps/SRE culture?",options:["It is the planned percentage of a monetary contract that is given back to a customer when an SLO is not met.","It is a best-practice metric for availability, equivalent to only six minutes of unplanned offline time per year.","It is an internal-only metric for calculating the actual availability of a service.","It is a method for measuring allowable errors as a gate on release speed."],correctIndex:3,explanation:"<strong>Error budgets</strong> define the number of allowable errors per unit time and are used as a gate on release speed."},
            {id:1210,module:"7",question:"Which programming language is used by Chef to execute the recipes?",options:["Bash","Python","Ruby","Javascript"],correctIndex:2,explanation:"Chef uses <strong>Ruby</strong> syntax for its recipes and cookbooks."},
            {id:1211,module:"7",question:"A developer issues a Linux command python3 -m venv devenv. What is the developer trying to achieve?",options:["to install the devnet tool sets in the Python 3 virtual environment named venv","to activate the Python 3 virtual environment named devenv","to enter the Python 3 virtual environment named venv using the devnet tool sets","to create a Python 3 virtual environment named devenv"],correctIndex:3,explanation:"<strong>python3 -m venv devenv</strong> creates a Python 3 virtual environment named devenv."},

            // ========== MODULE 8: Cisco Platforms and Development Quiz (8.8.4) ==========
            {id:1301,module:"8",question:"What is a characteristic of the Yet Another Next Generation (YANG) data model?",options:["It uses a MIBs structure.","It uses a tree structure.","It uses the JSON data format.","It uses a list structure."],correctIndex:1,explanation:"<strong>YANG models use a tree structure</strong>. The models are similar in format to XML and are constructed in modules."},
            {id:1302,module:"8",question:"Which two application-specific media types can be used for RESTCONF to identify a YANG construct? (Choose two.)",options:["application/yang+json+xml","application/yang-data+xml","application/yang-data+json","application/yang+xml","application/yang+json"],correctIndices:[1,2],type:"multi",explanation:"RESTCONF uses <strong>application/yang-data+xml</strong> and <strong>application/yang-data+json</strong> media types."},
            {id:1303,module:"8",question:"What is the name of the Cisco SD-WAN dashboard?",options:["vEdge","vManage","vBond","vSmart"],correctIndex:1,explanation:"<strong>vManage</strong> is the dashboard that provides a visual window into the SD-WAN network."},
            {id:1304,module:"8",question:"What is Cisco Finesse?",options:["an easy-to-use collaboration solution that keeps individuals and teams connected anytime and anywhere","a network management and analytics platform for Cisco Digital Network Architecture","a browser-based contact center agent and supervisor desktop","an application to manage phone users, phones, directory numbers, and to connect and manage calls to the desired destinations"],correctIndex:2,explanation:"<strong>Cisco Finesse</strong> is a browser-based contact center agent and supervisor desktop with many APIs."},
            {id:1305,module:"8",question:"Which Software as a Service (SaaS) management platform offers API keys for remote or service access?",options:["YANG Explorer","Management Information Tree","Cisco Intersight","APIC"],correctIndex:2,explanation:"<strong>Cisco Intersight</strong> is a SaaS management platform that offers API keys for remote access."},
            {id:1306,module:"8",question:"Which Cisco SDK is primarily a call widget that is embedded in an iframe within another web page for Cisco UCS application?",options:["Jabber Guest SDK for Web","Jabber Guest SDK for iOS","Jabber Guest SDK for Android","Jabber Web SDK"],correctIndex:0,explanation:"<strong>Jabber Guest SDK for Web</strong> is primarily a call widget embedded in an iframe."},
            {id:1307,module:"8",question:"A developer is using a REST API to develop an application to communicate with a Webex Teams server. What is the default maximum number of items that can be returned by the Webex Teams API prior to using pagination?",options:["100","150","25","50"],correctIndex:0,explanation:"The Webex Teams API returns up to <strong>100 items per page</strong> by default."},
            {id:1308,module:"8",question:"Refer to the exhibit. A network administrator is developing an application that communicates with Cisco AMP using an AMP API. A response from an AMP service shows the API rate limits information. What is the unit of value indicated under the item x-ratelimit-limit?",exhibit:"x-ratelimit-limit: 3000\nx-ratelimit-reset: 3588\nx-ratelimit-remaining: 2980",options:["responses","requests","bytes","seconds"],correctIndex:1,explanation:"X-Rate-Limit-Limit indicates the number of total allowed <strong>requests</strong> in the current period."},
            {id:1309,module:"8",question:"What is the default TCP port assigned for NETCONF over SSH?",options:["22","1080","443","830"],correctIndex:3,explanation:"The default NETCONF SSH port is <strong>830</strong>."},
            {id:1310,module:"8",question:"Where can a corporate developer access the API Explorer with the Firepower Threat Defense API?",options:["the URL address of the device itself","the domain name of the company","the local computer of the developer","on the DevNet web site"],correctIndex:0,explanation:"The FTD API Explorer can be accessed through <strong>the URL address of the device itself</strong>."}
        ];

        let filteredQuizData = [...allQuizData];
        let currentQuestionIndex = 0;
        let userAnswers = {};
        let revealState = {};
        let matchingSelections = {};
        let autoRevealEnabled = localStorage.getItem('autoReveal') === 'true';

        // Auto-reveal toggle function
        function toggleAutoReveal() {
            autoRevealEnabled = !autoRevealEnabled;
            localStorage.setItem('autoReveal', autoRevealEnabled);
            updateAutoRevealButton();
            showAutoRevealToast();
        }

        function showAutoRevealToast() {
            const toast = document.getElementById('toast');
            const content = document.getElementById('toast-content');
            const icon = document.getElementById('toast-icon');
            const message = document.getElementById('toast-message');
            
            if (autoRevealEnabled) {
                content.classList.remove('toast-off');
                content.classList.add('toast-on');
                icon.innerHTML = '<i class="fa-solid fa-bolt"></i>';
                message.textContent = 'Auto Check is on';
            } else {
                content.classList.remove('toast-on');
                content.classList.add('toast-off');
                icon.innerHTML = '<i class="fa-solid fa-bolt-slash"></i>';
                message.textContent = 'Auto Check is off';
            }
            
            // Show toast
            toast.classList.add('show');
            
            // Hide after 2 seconds
            setTimeout(() => {
                toast.classList.remove('show');
            }, 2000);
        }

        function updateAutoRevealButton() {
            const btn = document.getElementById('auto-reveal-btn');
            if (!btn) return;
            const icon = btn.querySelector('i');
            if (autoRevealEnabled) {
                icon.classList.remove('text-slate-400', 'dark:text-slate-500');
                icon.classList.add('text-amber-500', 'dark:text-amber-400');
                btn.title = 'Auto Reveal (on)';
                btn.classList.add('ring-2', 'ring-amber-400', 'dark:ring-amber-500');
            } else {
                icon.classList.remove('text-amber-500', 'dark:text-amber-400');
                icon.classList.add('text-slate-400', 'dark:text-slate-500');
                btn.title = 'Auto Reveal (off)';
                btn.classList.remove('ring-2', 'ring-amber-400', 'dark:ring-amber-500');
            }
        }

        // Check if answer is complete for auto-reveal
        function isAnswerComplete(data, qID) {
            if (data.type === 'matching') {
                const selections = matchingSelections[qID] || {};
                const requiredPairs = Object.keys(data.matchData.correctPairs).length;
                return Object.keys(selections).length >= requiredPairs;
            } else if (data.type === 'multi') {
                const selected = userAnswers[qID] || [];
                const requiredCount = data.correctIndices.length;
                return selected.length >= requiredCount;
            } else {
                return userAnswers[qID] !== undefined && userAnswers[qID] !== null;
            }
        }

        // Try auto-reveal if enabled and answer is complete
        function tryAutoReveal() {
            if (!autoRevealEnabled) return;
            const data = filteredQuizData[currentQuestionIndex];
            const qID = data.id;
            if (revealState[qID]) return; // Already revealed
            if (isAnswerComplete(data, qID)) {
                revealState[qID] = true;
                renderQuestion(false);
            }
        }

        const container = document.getElementById('quiz-container');
        const progressBar = document.getElementById('progress-bar');
        const currentQNum = document.getElementById('current-q-num');
        const totalQNum = document.getElementById('total-q-num');
        const prevBtn = document.getElementById('prev-btn');
        const prevBtnMobile = document.getElementById('prev-btn-mobile');
        const nextBtnDesktop = document.getElementById('next-btn-desktop');
        const nextBtnMobile = document.getElementById('next-btn-mobile');
        const revealBtn = document.getElementById('reveal-btn');
        const resetBtn = document.getElementById('reset-btn');
        const shuffleBtn = document.getElementById('shuffle-btn');
        const retakeBtnNav = document.getElementById('retake-btn-nav');

        function filterQuestions() {
            const filterValue = document.getElementById('module-filter').value;
            if (filterValue === 'all') {
                filteredQuizData = [...allQuizData];
            } else if (filterValue === 'final') {
                // Load final exam questions (separate from module questions)
                filteredQuizData = [...finalExamData];
            } else if (filterValue === 'netacad') {
                // Load combined Netacad quiz questions from all modules
                filteredQuizData = [...netacadQuizData];
            } else {
                filteredQuizData = allQuizData.filter(q => q.module === filterValue);
            }

            
            // Reset state when switching tabs
            userAnswers = {};
            revealState = {};
            matchingSelections = {};
            currentQuestionIndex = 0;
            initQuiz();
        }

        function initQuiz() {
            // Ensure UI is visible (in case it was hidden by results screen)
            const nav = document.getElementById('question-nav');
            const controls = document.getElementById('quiz-controls');
            if (nav) nav.style.display = 'block';
            if (controls) controls.style.display = 'flex';

            // Update auto-reveal button state
            updateAutoRevealButton();

            totalQNum.textContent = filteredQuizData.length;
            renderQuestionNav();
            renderQuestion();
        }

        function renderQuestion(animate = true) {
            if (filteredQuizData.length === 0) {
                container.innerHTML = `<div class="text-center text-slate-500 py-10">No questions found for this selection.</div>`;
                return;
            }

            const data = filteredQuizData[currentQuestionIndex];
            const qID = data.id;
            currentQNum.textContent = currentQuestionIndex + 1;
            
            const progress = ((currentQuestionIndex + 1) / filteredQuizData.length) * 100;
            progressBar.style.width = `${progress}%`;

            let contentHtml = '';

            // Handle different question types
            if (data.type === 'matching') {
                contentHtml = renderMatchingQuestion(data, qID);
            } else if (data.type === 'multi') {
                contentHtml = renderMultiChoiceQuestion(data, qID);
            } else {
                contentHtml = renderSingleChoiceQuestion(data, qID);
            }

            // Image/exhibit
            let exhibitHtml = '';
            if (data.image) {
                exhibitHtml += `<div class="mb-4"><img src="${data.image}" class="max-w-full h-auto rounded-lg border border-slate-200 dark:border-slate-600 mx-auto" alt="Question Exhibit" onerror="this.style.display='none';"></div>`;
            }
            if (data.exhibit) {
                exhibitHtml += `<div class="mb-6 p-4 bg-slate-50 dark:bg-slate-700 border border-slate-200 dark:border-slate-600 rounded-lg text-sm font-mono text-slate-700 dark:text-slate-300 whitespace-pre-wrap"><div class="font-bold text-slate-400 dark:text-slate-500 text-xs uppercase mb-1">Exhibit / Scenario</div>${data.exhibit}</div>`;
            }

            const explanationHtml = revealState[qID] ? `<div class="mt-6 p-4 bg-blue-50 dark:bg-blue-900/30 border-l-4 border-blue-500 text-slate-700 dark:text-slate-300 rounded-r-lg fade-in"><h3 class="font-bold text-blue-800 dark:text-blue-400 mb-1"><i class="fa-solid fa-circle-info mr-2"></i>Explanation</h3><p>${data.explanation}</p></div>` : '';

            // Check if in review mode (all questions revealed)
            const isReviewMode = Object.values(revealState).filter(v => v === true).length === filteredQuizData.length;
            
            const reviewBadge = isReviewMode ? '<span class="bg-indigo-100 dark:bg-indigo-900/50 text-indigo-800 dark:text-indigo-300 text-xs font-bold px-2.5 py-0.5 rounded border border-indigo-200 dark:border-indigo-700"><i class="fa-solid fa-magnifying-glass mr-1"></i>Review Mode</span>' : '';
            
            const reviewLegend = isReviewMode ? `
                <div class="mt-6 pt-4 border-t border-slate-200 dark:border-slate-700 text-center">
                    <p class="text-xs text-slate-500 dark:text-slate-400 mt-2">
                        <span class="inline-block w-3 h-3 rounded-full bg-green-500 mr-1"></span>Correct
                        <span class="inline-block w-3 h-3 rounded-full bg-red-500 ml-3 mr-1"></span>Wrong
                        <span class="inline-block w-3 h-3 rounded-full bg-amber-400 ml-3 mr-1"></span>Unanswered
                    </p>
                </div>
            ` : '';

            container.innerHTML = `
                <div class="${animate ? 'fade-in' : ''}">
                    <div class="mb-3 flex flex-wrap items-center gap-2">
                        <span class="bg-blue-100 dark:bg-blue-900/50 text-blue-800 dark:text-blue-300 text-xs font-bold px-2.5 py-0.5 rounded border border-blue-200 dark:border-blue-700">Module ${data.module}</span>
                        ${data.type === 'matching' ? '<span class="bg-purple-100 dark:bg-purple-900/50 text-purple-800 dark:text-purple-300 text-xs font-bold px-2.5 py-0.5 rounded border border-purple-200 dark:border-purple-700"><i class="fa-solid fa-arrows-left-right mr-1"></i>Matching</span>' : ''}
                        ${data.type === 'multi' ? '<span class="bg-amber-100 dark:bg-amber-900/50 text-amber-800 dark:text-amber-300 text-xs font-bold px-2.5 py-0.5 rounded border border-amber-200 dark:border-amber-700"><i class="fa-solid fa-list-check mr-1"></i>Multiple Answer</span>' : ''}
                        ${reviewBadge}
                    </div>
                    <h2 class="text-lg sm:text-xl md:text-2xl font-bold text-slate-800 dark:text-slate-100 mb-4 sm:mb-6 leading-snug">${data.question}</h2>
                    ${exhibitHtml}
                    ${contentHtml}
                    ${explanationHtml}
                    ${reviewLegend}
                </div>
            `;

            updateButtons();
            updateQuestionNav();
        }

        function renderSingleChoiceQuestion(data, qID) {
            let optionsHtml = '';
            data.options.forEach((opt, index) => {
                const isSelected = userAnswers[qID] === index;
                const isRevealed = revealState[qID];
                
                let labelClass = "option-label w-full p-3 sm:p-4 border-2 border-slate-200 dark:border-slate-600 rounded-lg cursor-pointer hover:bg-slate-50 dark:hover:bg-slate-700 flex items-center gap-3";
                let icon = '<div class="w-5 h-5 rounded-full border-2 border-slate-300 dark:border-slate-500 flex-shrink-0"></div>';

                if (isSelected && !isRevealed) {
                    labelClass += " border-blue-500 bg-blue-50 dark:bg-transparent dark:border-blue-400 dark:shadow-[0_0_15px_rgba(96,165,250,0.4)]";
                    icon = '<div class="w-5 h-5 rounded-full border-2 border-blue-500 flex items-center justify-center"><div class="w-2.5 h-2.5 bg-blue-500 rounded-full"></div></div>';
                }

                if (isRevealed) {
                    const hasAnswered = userAnswers[qID] !== undefined && userAnswers[qID] !== null;
                    if (index === data.correctIndex) {
                        if (hasAnswered) {
                            // User answered - show green for correct
                            labelClass = "option-label w-full p-4 border-2 rounded-lg flex items-center gap-3 correct-answer cursor-default";
                            icon = '<i class="fa-solid fa-circle-check text-green-600 text-lg"></i>';
                        } else {
                            // User didn't answer - show amber for correct answer
                            labelClass = "option-label w-full p-4 border-2 border-amber-400 dark:border-amber-500 bg-amber-50 dark:bg-amber-900/30 rounded-lg flex items-center gap-3 cursor-default";
                            icon = '<i class="fa-solid fa-triangle-exclamation text-amber-500 text-lg"></i>';
                        }
                    } else if (isSelected && index !== data.correctIndex) {
                        labelClass = "option-label w-full p-4 border-2 rounded-lg flex items-center gap-3 incorrect-answer cursor-default";
                        icon = '<i class="fa-solid fa-circle-xmark text-red-500 text-lg"></i>';
                    } else {
                        labelClass += " opacity-60 cursor-default";
                    }
                }

                optionsHtml += `
                    <label class="${labelClass}">
                        <input type="radio" name="q${qID}" value="${index}" class="option-input hidden" ${isSelected ? 'checked' : ''} ${isRevealed ? 'disabled' : ''} onchange="selectOption(${index})">
                        ${icon}
                        <span class="text-slate-700 dark:text-slate-200 font-medium text-sm sm:text-base">${opt}</span>
                    </label>
                `;
            });
            return `<div class="space-y-3">${optionsHtml}</div>`;
        }

        function renderMultiChoiceQuestion(data, qID) {
            let optionsHtml = '';
            const selectedAnswers = userAnswers[qID] || [];
            const isRevealed = revealState[qID];

            data.options.forEach((opt, index) => {
                const isSelected = selectedAnswers.includes(index);
                const isCorrect = data.correctIndices.includes(index);
                
                let labelClass = "option-label w-full p-3 sm:p-4 border-2 border-slate-200 dark:border-slate-600 rounded-lg cursor-pointer hover:bg-slate-50 dark:hover:bg-slate-700 flex items-center gap-3";
                let icon = '<div class="w-5 h-5 rounded border-2 border-slate-300 dark:border-slate-500 flex-shrink-0"></div>';

                if (isSelected && !isRevealed) {
                    labelClass += " border-blue-500 bg-blue-50 dark:bg-transparent dark:border-blue-400 dark:shadow-[0_0_15px_rgba(96,165,250,0.4)]";
                    icon = '<div class="w-5 h-5 rounded border-2 border-blue-500 bg-blue-500 flex items-center justify-center"><i class="fa-solid fa-check text-white text-xs"></i></div>';
                }

                if (isRevealed) {
                    if (isSelected && isCorrect) {
                        // Correctly selected - green
                        labelClass = "option-label w-full p-4 border-2 rounded-lg flex items-center gap-3 correct-answer cursor-default";
                        icon = '<i class="fa-solid fa-circle-check text-green-600 text-lg"></i>';
                    } else if (isSelected && !isCorrect) {
                        // Incorrectly selected - red
                        labelClass = "option-label w-full p-4 border-2 rounded-lg flex items-center gap-3 incorrect-answer cursor-default";
                        icon = '<i class="fa-solid fa-circle-xmark text-red-500 text-lg"></i>';
                    } else if (!isSelected && isCorrect) {
                        // Missed correct answer - amber (should have selected this)
                        labelClass = "option-label w-full p-4 border-2 border-amber-400 dark:border-amber-500 bg-amber-50 dark:bg-amber-900/30 rounded-lg flex items-center gap-3 cursor-default";
                        icon = '<i class="fa-solid fa-triangle-exclamation text-amber-500 text-lg"></i>';
                    } else {
                        // Correctly not selected (wrong option left unselected) - dimmed
                        labelClass += " opacity-60 cursor-default";
                    }
                }

                optionsHtml += `
                    <label class="${labelClass}">
                        <input type="checkbox" name="q${qID}" value="${index}" class="hidden" ${isSelected ? 'checked' : ''} ${isRevealed ? 'disabled' : ''} onchange="toggleMultiOption(${index})">
                        ${icon}
                        <span class="text-slate-700 dark:text-slate-200 font-medium text-sm sm:text-base">${opt}</span>
                    </label>
                `;
            });
            return `<div class="space-y-3">${optionsHtml}</div>`;
        }

        function renderMatchingQuestion(data, qID) {
            const selections = matchingSelections[qID] || {};
            const isRevealed = revealState[qID];
            
            // Get used items (left items that have been matched)
            const usedLeftItems = Object.keys(selections);
            
            // Calculate match progress
            const requiredPairs = Object.keys(data.matchData.correctPairs).length;
            const currentMatches = Object.keys(selections).length;
            const matchProgress = `${currentMatches}/${requiredPairs}`;
            const isComplete = currentMatches >= requiredPairs;
            
            // Shuffle left items for display (but keep consistent during session)
            if (!window.shuffledLeftItems) window.shuffledLeftItems = {};
            if (!window.shuffledLeftItems[qID]) {
                window.shuffledLeftItems[qID] = [...data.matchData.leftItems].sort(() => Math.random() - 0.5);
            }
            const shuffledLeftItems = window.shuffledLeftItems[qID];
            
            let html = '<div class="grid md:grid-cols-2 gap-4 sm:gap-6">';
            
            // Left column - Draggable items (questions/terms) with progress indicator
            html += `<div class="space-y-2 sm:space-y-3">
                <div class="flex items-center justify-between">
                    <h3 class="font-semibold text-slate-600 dark:text-slate-400 text-sm sm:text-base"><i class="fa-solid fa-hand-pointer mr-2"></i>Items (Tap or Drag)</h3>
                    <span class="text-xs font-bold px-2 py-1 rounded-full ${isComplete ? 'bg-green-100 dark:bg-green-900/50 text-green-700 dark:text-green-400' : 'bg-blue-100 dark:bg-blue-900/50 text-blue-700 dark:text-blue-400'}">
                        <i class="fa-solid ${isComplete ? 'fa-check-circle' : 'fa-link'} mr-1"></i>${matchProgress} matched
                    </span>
                </div>`;
            shuffledLeftItems.forEach((item, idx) => {
                const isUsed = usedLeftItems.includes(item);
                const isSelected = selectedLeftItem === item;
                const matchedAnswer = selections[item];
                let dragCls = 'drag-item p-2 sm:p-3 border-2 rounded-lg bg-white dark:bg-slate-700 dark:text-slate-200 text-sm sm:text-base cursor-pointer transition-all';
                if (isUsed) {
                    dragCls += ' used border-slate-200 dark:border-slate-600';
                } else if (isSelected) {
                    dragCls += ' ring-2 ring-blue-500 border-blue-400 dark:border-blue-500 bg-blue-50 dark:bg-blue-900/30';
                } else {
                    dragCls += ' border-slate-200 dark:border-slate-600 hover:border-blue-300 dark:hover:border-blue-500';
                }
                
                html += `<div class="${dragCls}" 
                    draggable="${!isUsed && !isRevealed}" 
                    data-left-item="${item}" 
                    onclick="selectLeftItem('${item.replace(/'/g, "\\'")}')" 
                    ondragstart="handleDragStart(event, '${item.replace(/'/g, "\\'")}')" 
                    ondragend="handleDragEnd(event)">
                    <i class="fa-solid ${isSelected ? 'fa-circle-check text-blue-500' : 'fa-grip-vertical text-slate-400 dark:text-slate-500'} mr-2"></i>${item}
                    ${isUsed ? '<i class="fa-solid fa-check ml-2 text-blue-500"></i>' : ''}
                    ${isSelected ? '<span class="ml-auto text-xs text-blue-500 font-medium">Selected</span>' : ''}
                </div>`;
            });
            html += '</div>';
            
            // Right column - Drop zones (answers/definitions)
            html += '<div class="space-y-2 sm:space-y-3"><h3 class="font-semibold text-slate-600 dark:text-slate-400 mb-2 text-sm sm:text-base"><i class="fa-solid fa-bullseye mr-2"></i>Answers (Tap to Match)</h3>';
            data.matchData.rightItems.forEach((answer, idx) => {
                // Find which left item is matched to this answer
                const matchedLeftItem = Object.keys(selections).find(key => selections[key] === answer);
                const correctLeftItem = Object.keys(data.matchData.correctPairs).find(key => data.matchData.correctPairs[key] === answer);
                const isCorrect = isRevealed && matchedLeftItem && matchedLeftItem === correctLeftItem;
                const isIncorrect = isRevealed && matchedLeftItem && matchedLeftItem !== correctLeftItem;
                
                let dropCls = 'drop-zone p-2 sm:p-3 rounded-lg text-sm sm:text-base flex flex-col gap-1 cursor-pointer transition-all';
                if (matchedLeftItem) dropCls += ' filled';
                if (isCorrect) dropCls += ' correct';
                if (isIncorrect) dropCls += ' incorrect';
                
                html += `<div class="${dropCls}" 
                    data-answer="${answer}" 
                    ondragover="handleDragOver(event)" 
                    ondragleave="handleDragLeave(event)" 
                    ondrop="handleDrop(event, '${answer.replace(/'/g, "\\'")}')" 
                    onclick="handleDropZoneClick('${answer.replace(/'/g, "\\'")}', ${matchedLeftItem ? "'" + matchedLeftItem.replace(/'/g, "\\'") + "'" : 'null'})">
                    <div class="flex items-center gap-2">
                        <span class="font-semibold ${matchedLeftItem ? (isCorrect ? 'text-green-700 dark:text-green-400' : isIncorrect ? 'text-red-600 dark:text-red-400' : 'text-blue-700 dark:text-blue-400') : 'text-slate-400 dark:text-slate-500 italic'}">
                            ${matchedLeftItem || (selectedLeftItem ? 'Tap here to match' : 'Select an item first')}
                        </span>
                        ${isCorrect ? '<i class="fa-solid fa-check text-green-600"></i>' : ''}
                        ${isIncorrect ? '<i class="fa-solid fa-xmark text-red-500"></i>' : ''}
                        <span class="match-arrow dark:text-slate-400 ml-auto"><i class="fa-solid fa-arrow-right"></i></span>
                    </div>
                    <div class="text-slate-600 dark:text-slate-300 text-xs sm:text-sm leading-snug">${answer}</div>
                    ${isRevealed && isIncorrect && correctLeftItem ? '<div class="text-xs text-green-600 dark:text-green-400 mt-1 bg-green-50 dark:bg-green-900/30 p-1 rounded"><i class="fa-solid fa-check mr-1"></i>Correct: <strong>' + correctLeftItem + '</strong></div>' : ''}
                    ${isRevealed && !matchedLeftItem && correctLeftItem ? '<div class="text-xs text-amber-600 dark:text-amber-400 mt-1 bg-amber-50 dark:bg-amber-900/30 p-1 rounded"><i class="fa-solid fa-triangle-exclamation mr-1"></i>Answer: <strong>' + correctLeftItem + '</strong></div>' : ''}
                </div>`;
            });
            html += '</div></div>';
            
            // Instructions
            html += `<p class="text-xs sm:text-sm text-slate-500 dark:text-slate-400 mt-4"><i class="fa-solid fa-lightbulb mr-1 text-amber-500"></i><strong>Tap mode:</strong> Tap an item to select it, then tap an answer to match. <strong>Drag mode:</strong> Drag items directly to answers. Tap a matched slot to remove.</p>`;
            
            // Show correct pairs if revealed
            if (isRevealed) {
                html += '<div class="mt-4 p-4 bg-green-50 dark:bg-green-900/30 border border-green-200 dark:border-green-700 rounded-lg"><h4 class="font-semibold text-green-800 dark:text-green-400 mb-2"><i class="fa-solid fa-check-double mr-2"></i>Correct Matches:</h4><ul class="space-y-1">';
                for (let [left, right] of Object.entries(data.matchData.correctPairs)) {
                    const userAnswer = selections[left];
                    const isMatch = userAnswer === right;
                    html += `<li class="${isMatch ? 'text-green-700 dark:text-green-400' : 'text-red-600 dark:text-red-400'}"><strong>${left}</strong> ‚Üí ${right} ${isMatch ? '<i class="fa-solid fa-check"></i>' : ''}</li>`;
                }
                html += '</ul></div>';
            }
            
            return html;
        }
        
        // Drag and Drop handlers
        let draggedItem = null;
        let draggedElement = null;
        
        // Click-to-select mode for mobile
        let selectedLeftItem = null;
        
        function handleDragStart(event, leftItem) {
            draggedItem = leftItem;
            draggedElement = event.target;
            event.target.classList.add('dragging');
            event.dataTransfer.effectAllowed = 'move';
            event.dataTransfer.setData('text/plain', leftItem);
        }
        
        function handleDragEnd(event) {
            event.target.classList.remove('dragging');
            draggedItem = null;
            // Remove drag-over class from all drop zones
            document.querySelectorAll('.drop-zone').forEach(zone => zone.classList.remove('drag-over'));
        }
        
        function handleDragOver(event) {
            event.preventDefault();
            event.dataTransfer.dropEffect = 'move';
            event.currentTarget.classList.add('drag-over');
        }
        
        function handleDragLeave(event) {
            event.currentTarget.classList.remove('drag-over');
        }
        
        function handleDrop(event, answer) {
            event.preventDefault();
            event.currentTarget.classList.remove('drag-over');
            
            const data = filteredQuizData[currentQuestionIndex];
            const qID = data.id;
            if (revealState[qID]) return;
            
            const leftItem = event.dataTransfer.getData('text/plain') || draggedItem;
            if (!leftItem) return;
            
            if (!matchingSelections[qID]) matchingSelections[qID] = {};
            
            // Check if this left item is already matched elsewhere - remove old match
            if (matchingSelections[qID][leftItem]) {
                delete matchingSelections[qID][leftItem];
            }
            
            // Check if this answer already has a different item matched - remove it
            for (let key in matchingSelections[qID]) {
                if (matchingSelections[qID][key] === answer) {
                    delete matchingSelections[qID][key];
                }
            }
            
            matchingSelections[qID][leftItem] = answer;
            renderQuestion(false);
            tryAutoReveal();
        }
        
        function removeMatch(leftItem) {
            const data = filteredQuizData[currentQuestionIndex];
            const qID = data.id;
            if (revealState[qID]) return;
            
            if (matchingSelections[qID] && matchingSelections[qID][leftItem]) {
                delete matchingSelections[qID][leftItem];
                renderQuestion(false);
            }
        }
        
        // Click-to-select mode functions
        function selectLeftItem(item) {
            const data = filteredQuizData[currentQuestionIndex];
            const qID = data.id;
            if (revealState[qID]) return;
            
            // Check if item is already used
            const selections = matchingSelections[qID] || {};
            if (Object.keys(selections).includes(item)) {
                // Already matched - deselect
                selectedLeftItem = null;
                renderQuestion(false);
                return;
            }
            
            // Toggle selection
            if (selectedLeftItem === item) {
                selectedLeftItem = null; // Deselect
            } else {
                selectedLeftItem = item; // Select
            }
            renderQuestion(false);
        }
        
        function handleDropZoneClick(answer, matchedLeftItem) {
            const data = filteredQuizData[currentQuestionIndex];
            const qID = data.id;
            if (revealState[qID]) return;
            
            // If there's a selected item, make a match
            if (selectedLeftItem) {
                if (!matchingSelections[qID]) matchingSelections[qID] = {};
                
                // Remove any existing match for this left item
                if (matchingSelections[qID][selectedLeftItem]) {
                    delete matchingSelections[qID][selectedLeftItem];
                }
                
                // Remove any existing match for this answer
                for (let key in matchingSelections[qID]) {
                    if (matchingSelections[qID][key] === answer) {
                        delete matchingSelections[qID][key];
                    }
                }
                
                matchingSelections[qID][selectedLeftItem] = answer;
                selectedLeftItem = null; // Clear selection
                renderQuestion(false);
                tryAutoReveal();
            } else if (matchedLeftItem) {
                // No selection but there's a match - remove it
                removeMatch(matchedLeftItem);
            }
        }
        
        // Touch event handlers for mobile drag and drop
        let touchDragItem = null;
        let touchDragElement = null;
        let touchClone = null;
        let touchStartY = 0;
        
        function handleTouchStart(event, leftItem) {
            const data = filteredQuizData[currentQuestionIndex];
            if (revealState[data.id]) return;
            
            // Check if item is already used
            const selections = matchingSelections[data.id] || {};
            if (Object.keys(selections).includes(leftItem)) return;
            
            touchDragItem = leftItem;
            touchDragElement = event.currentTarget;
            touchStartY = event.touches[0].clientY;
            
            // Add visual feedback
            touchDragElement.classList.add('dragging');
            
            // Create floating clone for visual feedback
            touchClone = touchDragElement.cloneNode(true);
            touchClone.style.position = 'fixed';
            touchClone.style.zIndex = '1000';
            touchClone.style.pointerEvents = 'none';
            touchClone.style.opacity = '0.8';
            touchClone.style.transform = 'scale(1.05)';
            touchClone.style.boxShadow = '0 4px 12px rgba(0,0,0,0.3)';
            document.body.appendChild(touchClone);
            
            updateTouchClonePosition(event.touches[0]);
        }
        
        function handleTouchMove(event) {
            if (!touchDragItem || !touchClone) return;
            event.preventDefault();
            
            updateTouchClonePosition(event.touches[0]);
            
            // Highlight drop zone under finger
            document.querySelectorAll('.drop-zone').forEach(zone => {
                zone.classList.remove('drag-over');
            });
            const target = document.elementFromPoint(event.touches[0].clientX, event.touches[0].clientY);
            if (target) {
                const dropZone = target.closest('.drop-zone');
                if (dropZone) {
                    dropZone.classList.add('drag-over');
                }
            }
        }
        
        function handleTouchEnd(event) {
            if (!touchDragItem) return;
            
            // Find drop zone under finger
            const touch = event.changedTouches[0];
            const target = document.elementFromPoint(touch.clientX, touch.clientY);
            
            if (target) {
                const dropZone = target.closest('.drop-zone');
                if (dropZone) {
                    const answer = dropZone.getAttribute('data-answer');
                    if (answer) {
                        performDrop(touchDragItem, answer);
                    }
                }
            }
            
            // Cleanup
            if (touchDragElement) touchDragElement.classList.remove('dragging');
            if (touchClone) touchClone.remove();
            document.querySelectorAll('.drop-zone').forEach(zone => zone.classList.remove('drag-over'));
            
            touchDragItem = null;
            touchDragElement = null;
            touchClone = null;
        }
        
        function updateTouchClonePosition(touch) {
            if (!touchClone) return;
            touchClone.style.left = (touch.clientX - 100) + 'px';
            touchClone.style.top = (touch.clientY - 25) + 'px';
            touchClone.style.width = '200px';
        }
        
        function performDrop(leftItem, answer) {
            const data = filteredQuizData[currentQuestionIndex];
            const qID = data.id;
            if (revealState[qID]) return;
            
            if (!matchingSelections[qID]) matchingSelections[qID] = {};
            
            // Check if this left item is already matched elsewhere - remove old match
            if (matchingSelections[qID][leftItem]) {
                delete matchingSelections[qID][leftItem];
            }
            
            // Check if this answer already has a different item matched - remove it
            for (let key in matchingSelections[qID]) {
                if (matchingSelections[qID][key] === answer) {
                    delete matchingSelections[qID][key];
                }
            }
            
            matchingSelections[qID][leftItem] = answer;
            renderQuestion(false);
            tryAutoReveal();
        }

        function selectOption(index) {
            const qID = filteredQuizData[currentQuestionIndex].id;
            if (revealState[qID]) return;
            userAnswers[qID] = index;
            renderQuestion(false);
            tryAutoReveal();
        }

        function toggleMultiOption(index) {
            const qID = filteredQuizData[currentQuestionIndex].id;
            if (revealState[qID]) return;
            if (!userAnswers[qID]) userAnswers[qID] = [];
            const idx = userAnswers[qID].indexOf(index);
            if (idx > -1) {
                userAnswers[qID].splice(idx, 1);
            } else {
                userAnswers[qID].push(index);
            }
            renderQuestion(false);
            tryAutoReveal();
        }

        // selectMatchAnswer is no longer used - replaced by drag and drop
        function selectMatchAnswer(answer) {
            // Legacy function - kept for compatibility
            console.log('Use drag and drop instead');
        }

        function revealAnswer() {
            const data = filteredQuizData[currentQuestionIndex];
            const qID = data.id;
            revealState[qID] = true;
            
            // DO NOT auto-populate for matching questions - keep user's wrong answers visible
            // so they can see their mistakes with red highlighting
            
            renderQuestion(false);
        }

        function resetCurrentQuestion() {
            const qID = filteredQuizData[currentQuestionIndex].id;
            userAnswers[qID] = null;
            revealState[qID] = false;
            matchingSelections[qID] = {};
            renderQuestion(false);
        }

        function shuffleQuestions() {
            const modal = document.getElementById('confirm-modal');
            const content = document.getElementById('modal-content');
            
            modal.classList.remove('hidden');
            // Small delay to allow display:block to apply before opacity transition
            setTimeout(() => {
                modal.classList.remove('opacity-0');
                content.classList.remove('scale-95');
                content.classList.add('scale-100');
            }, 10);
        }

        function closeConfirmModal() {
            const modal = document.getElementById('confirm-modal');
            const content = document.getElementById('modal-content');
            
            modal.classList.add('opacity-0');
            content.classList.remove('scale-100');
            content.classList.add('scale-95');
            
            setTimeout(() => {
                modal.classList.add('hidden');
            }, 200);
        }

        function confirmShuffle() {
            // 1. Shuffle the order of questions
            for (let i = filteredQuizData.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [filteredQuizData[i], filteredQuizData[j]] = [filteredQuizData[j], filteredQuizData[i]];
            }

            // 2. Shuffle choices within each question
            filteredQuizData.forEach(q => {
                const qID = q.id;

                // Handle Matching Questions
                if (q.type === 'matching') {
                    // Reset the display shuffle cache for left items
                    if (window.shuffledLeftItems && window.shuffledLeftItems[qID]) {
                        delete window.shuffledLeftItems[qID];
                    }
                    
                    // Shuffle the actual left items in data (draggables)
                    if (q.matchData && q.matchData.leftItems) {
                         for (let i = q.matchData.leftItems.length - 1; i > 0; i--) {
                            const j = Math.floor(Math.random() * (i + 1));
                            [q.matchData.leftItems[i], q.matchData.leftItems[j]] = [q.matchData.leftItems[j], q.matchData.leftItems[i]];
                        }
                    }
                    
                    // Shuffle the right items in data (drop zones)
                    if (q.matchData && q.matchData.rightItems) {
                         for (let i = q.matchData.rightItems.length - 1; i > 0; i--) {
                            const j = Math.floor(Math.random() * (i + 1));
                            [q.matchData.rightItems[i], q.matchData.rightItems[j]] = [q.matchData.rightItems[j], q.matchData.rightItems[i]];
                        }
                    }
                    
                    return;
                }

                // Handle Single/Multi Choice
                if (!q.options || q.options.length < 2) return;

                // Create array of indices [0, 1, 2...]
                let indices = q.options.map((_, i) => i);
                
                // Shuffle indices
                for (let i = indices.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [indices[i], indices[j]] = [indices[j], indices[i]];
                }

                // Remap options
                const newOptions = indices.map(i => q.options[i]);
                
                // Update correct index/indices map
                let newCorrectIndex;
                let newCorrectIndices;

                if (q.type === 'multi') {
                    // Find where the old correct indices moved to
                    newCorrectIndices = indices
                        .map((oldIdx, newPos) => q.correctIndices.includes(oldIdx) ? newPos : -1)
                        .filter(idx => idx !== -1);
                } else {
                    // Find where the old correct index moved to
                    newCorrectIndex = indices.indexOf(q.correctIndex);
                }

                // Update user answers map if user has already answered
                if (userAnswers[qID] !== undefined && userAnswers[qID] !== null) {
                    if (q.type === 'multi') {
                        const oldUserIndices = userAnswers[qID];
                        userAnswers[qID] = indices
                            .map((oldIdx, newPos) => oldUserIndices.includes(oldIdx) ? newPos : -1)
                            .filter(idx => idx !== -1);
                    } else {
                        const oldUserIdx = userAnswers[qID];
                        userAnswers[qID] = indices.indexOf(oldUserIdx);
                    }
                }

                // Apply changes to the question object
                q.options = newOptions;
                if (q.type === 'multi') {
                    q.correctIndices = newCorrectIndices;
                } else {
                    q.correctIndex = newCorrectIndex;
                }
            });
            
            // Go back to first question
            currentQuestionIndex = 0;
            renderQuestionNav();
            renderQuestion();
            closeConfirmModal();
        }

        function nextQuestion() {
            if (currentQuestionIndex < filteredQuizData.length - 1) {
                currentQuestionIndex++;
                renderQuestion();
            } else {
                // Last question - submit the quiz
                submitQuiz();
            }
        }

        function prevQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                renderQuestion();
            }
        }
        
        // Question Navigator Functions
        function renderQuestionNav() {
            const dotsContainer = document.getElementById('question-dots');
            let html = '';
            
            filteredQuizData.forEach((q, idx) => {
                html += `<button onclick="goToQuestion(${idx})" 
                    class="question-dot w-7 h-7 sm:w-8 sm:h-8 rounded-full text-xs font-bold transition-all
                    ${idx === currentQuestionIndex ? 'ring-2 ring-offset-2 ring-blue-500 dark:ring-offset-slate-900' : ''}
                    bg-slate-200 dark:bg-slate-600 text-slate-600 dark:text-slate-300 hover:bg-slate-300 dark:hover:bg-slate-500"
                    data-idx="${idx}" title="Question ${idx + 1}">
                    ${idx + 1}
                </button>`;
            });
            
            dotsContainer.innerHTML = html;
        }
        
        function updateQuestionNav() {
            const dots = document.querySelectorAll('.question-dot');
            const isReviewMode = Object.values(revealState).some(v => v === true);
            
            dots.forEach((dot, idx) => {
                const q = filteredQuizData[idx];
                const qID = q.id;
                const isCurrent = idx === currentQuestionIndex;
                
                // Reset classes
                dot.className = 'question-dot w-7 h-7 sm:w-8 sm:h-8 rounded-full text-xs font-bold transition-all';
                
                if (isCurrent) {
                    dot.classList.add('ring-2', 'ring-offset-2', 'ring-blue-500', 'dark:ring-offset-slate-900');
                }
                
                if (isReviewMode && revealState[qID]) {
                    // Check answer status
                    const status = getQuestionStatus(q, qID);
                    
                    if (status === 'correct') {
                        dot.classList.add('bg-green-500', 'dark:bg-green-600', 'text-white');
                    } else if (status === 'incorrect') {
                        dot.classList.add('bg-red-500', 'dark:bg-red-600', 'text-white');
                    } else if (status === 'unanswered') {
                        dot.classList.add('bg-amber-400', 'dark:bg-amber-500', 'text-white');
                    }
                } else {
                    // Normal mode - check if answered
                    const hasAnswer = hasUserAnswered(q, qID);
                    if (hasAnswer) {
                        dot.classList.add('bg-blue-500', 'dark:bg-blue-600', 'text-white');
                    } else {
                        dot.classList.add('bg-slate-200', 'dark:bg-slate-600', 'text-slate-600', 'dark:text-slate-300', 'hover:bg-slate-300', 'dark:hover:bg-slate-500');
                    }
                }
            });
        }
        
        function getQuestionStatus(q, qID) {
            if (q.type === 'matching') {
                const selections = matchingSelections[qID] || {};
                const correctPairs = q.matchData.correctPairs;
                
                if (Object.keys(selections).length === 0) return 'unanswered';
                
                let allCorrect = true;
                for (let [left, right] of Object.entries(correctPairs)) {
                    if (selections[left] !== right) allCorrect = false;
                }
                return allCorrect ? 'correct' : 'incorrect';
                
            } else if (q.type === 'multi') {
                const selected = userAnswers[qID] || [];
                const correctIndices = q.correctIndices || [];
                
                if (selected.length === 0) return 'unanswered';
                
                const selectedSorted = [...selected].sort().join(',');
                const correctSorted = [...correctIndices].sort().join(',');
                return selectedSorted === correctSorted ? 'correct' : 'incorrect';
                
            } else {
                const selected = userAnswers[qID];
                if (selected === undefined || selected === null) return 'unanswered';
                return selected === q.correctIndex ? 'correct' : 'incorrect';
            }
        }
        
        function hasUserAnswered(q, qID) {
            if (q.type === 'matching') {
                const selections = matchingSelections[qID] || {};
                return Object.keys(selections).length > 0;
            } else if (q.type === 'multi') {
                const selected = userAnswers[qID] || [];
                return selected.length > 0;
            } else {
                return userAnswers[qID] !== undefined && userAnswers[qID] !== null;
            }
        }
        
        function goToQuestion(idx) {
            if (idx >= 0 && idx < filteredQuizData.length) {
                currentQuestionIndex = idx;
                renderQuestion();
            }
        }

        function updateButtons() {
            const qID = filteredQuizData[currentQuestionIndex].id;
            
            // Update Previous buttons
            const isFirstQuestion = currentQuestionIndex === 0;
            if (prevBtn) prevBtn.disabled = isFirstQuestion;
            if (prevBtnMobile) prevBtnMobile.disabled = isFirstQuestion;
            
            // Update Next buttons
            const isLastQuestion = currentQuestionIndex === filteredQuizData.length - 1;
            const nextButtons = [nextBtnDesktop, nextBtnMobile];
            
            nextButtons.forEach(btn => {
                if (!btn) return;
                
                if (isLastQuestion) {
                    btn.innerHTML = '<i class="fa-solid fa-paper-plane"></i> <span class="hidden sm:inline">Submit</span><span class="sm:hidden">Submit</span>';
                    btn.disabled = false;
                    btn.classList.remove('bg-blue-600', 'dark:bg-blue-500', 'hover:bg-blue-700', 'dark:hover:bg-blue-600');
                    btn.classList.add('bg-green-600', 'dark:bg-green-500', 'hover:bg-green-700', 'dark:hover:bg-green-600');
                } else {
                    btn.innerHTML = 'Next <i class="fa-solid fa-arrow-right"></i>';
                    btn.disabled = false;
                    btn.classList.remove('bg-green-600', 'dark:bg-green-500', 'hover:bg-green-700', 'dark:hover:bg-green-600');
                    btn.classList.add('bg-blue-600', 'dark:bg-blue-500', 'hover:bg-blue-700', 'dark:hover:bg-blue-600');
                }
            });
            
            // Check if we are in review mode (all questions revealed)
            const isReviewMode = filteredQuizData.length > 0 && filteredQuizData.every(q => revealState[q.id]);
            
            if (isReviewMode) {
                // Review Mode: Hide Reveal & Reset, Show Retake
                revealBtn.style.display = 'none';
                resetBtn.style.display = 'none';
                if (shuffleBtn) shuffleBtn.style.display = 'none';
                if (retakeBtnNav) {
                    retakeBtnNav.style.display = 'flex';
                    retakeBtnNav.classList.add('flex-1');
                }
            } else {
                // Normal Mode: Hide Retake, show normal buttons
                if (retakeBtnNav) retakeBtnNav.style.display = 'none';
                
                if (revealState[qID]) {
                    revealBtn.style.display = 'none';
                    if (shuffleBtn) shuffleBtn.style.display = 'none';
                    resetBtn.style.display = 'flex';
                    resetBtn.classList.add('flex-1');
                } else {
                    revealBtn.style.display = 'flex';
                    if (shuffleBtn) shuffleBtn.style.display = 'flex';
                    resetBtn.style.display = 'flex';
                    resetBtn.classList.remove('flex-1');
                }
            }
        }
        
        function submitQuiz() {
            let correct = 0;
            let answered = 0;
            let total = filteredQuizData.length;
            let details = [];
            
            filteredQuizData.forEach((q, idx) => {
                const qID = q.id;
                let isCorrect = false;
                let userAnswer = '';
                let correctAnswer = '';
                
                if (q.type === 'matching') {
                    // Matching question
                    const selections = matchingSelections[qID] || {};
                    const correctPairs = q.matchData.correctPairs;
                    let matchCorrect = 0;
                    let matchTotal = Object.keys(correctPairs).length;
                    
                    for (let [left, right] of Object.entries(correctPairs)) {
                        if (selections[left] === right) matchCorrect++;
                    }
                    
                    isCorrect = matchCorrect === matchTotal;
                    userAnswer = Object.keys(selections).length > 0 ? `${matchCorrect}/${matchTotal} matches` : 'Not answered';
                    correctAnswer = `${matchTotal} correct matches needed`;
                    if (Object.keys(selections).length > 0) answered++;
                    
                } else if (q.type === 'multi') {
                    // Multiple answer question
                    const selected = userAnswers[qID] || [];
                    const correctIndices = q.correctIndices || [];
                    
                    const selectedSorted = [...selected].sort().join(',');
                    const correctSorted = [...correctIndices].sort().join(',');
                    isCorrect = selectedSorted === correctSorted;
                    
                    userAnswer = selected.length > 0 ? selected.map(i => q.options[i]).join(', ') : 'Not answered';
                    correctAnswer = correctIndices.map(i => q.options[i]).join(', ');
                    if (selected.length > 0) answered++;
                    
                } else {
                    // Single choice question
                    const selected = userAnswers[qID];
                    isCorrect = selected === q.correctIndex;
                    
                    userAnswer = selected !== undefined && selected !== null ? q.options[selected] : 'Not answered';
                    correctAnswer = q.options[q.correctIndex];
                    if (selected !== undefined && selected !== null) answered++;
                }
                
                if (isCorrect) correct++;
                details.push({ question: q.question.substring(0, 60) + '...', isCorrect, userAnswer, correctAnswer, type: q.type || 'single' });
            });
            
            const percentage = Math.round((correct / total) * 100);
            const grade = percentage >= 90 ? 'A' : percentage >= 80 ? 'B' : percentage >= 70 ? 'C' : percentage >= 60 ? 'D' : 'F';
            const gradeColor = percentage >= 80 ? 'text-green-600 dark:text-green-400' : percentage >= 60 ? 'text-yellow-600 dark:text-yellow-400' : 'text-red-600 dark:text-red-400';
            
            // Get current filter name
            const filterValue = document.getElementById('module-filter').value;
            let filterName = 'All Modules';
            if (filterValue === 'final') filterName = 'Final Exam (Mod 5-8)';
            else if (filterValue !== 'all') filterName = 'Module ' + filterValue;
            
            // Display results
            container.innerHTML = `
                <div class="fade-in text-center py-6">
                    <div class="mb-6">
                        <i class="fa-solid fa-trophy text-6xl ${gradeColor} mb-4"></i>
                        <h2 class="text-2xl sm:text-3xl font-bold text-slate-800 dark:text-slate-100 mb-2">Quiz Complete!</h2>
                        <p class="text-slate-500 dark:text-slate-400">${filterName}</p>
                    </div>
                    
                    <div class="bg-slate-50 dark:bg-slate-700/50 rounded-2xl p-6 mb-6 inline-block">
                        <div class="text-6xl sm:text-7xl font-bold ${gradeColor} mb-2">${percentage}%</div>
                        <div class="text-2xl font-bold ${gradeColor} mb-4">Grade: ${grade}</div>
                        <div class="grid grid-cols-3 gap-4 text-center">
                            <div>
                                <div class="text-2xl font-bold text-green-600 dark:text-green-400">${correct}</div>
                                <div class="text-xs text-slate-500 dark:text-slate-400">Correct</div>
                            </div>
                            <div>
                                <div class="text-2xl font-bold text-red-600 dark:text-red-400">${total - correct}</div>
                                <div class="text-xs text-slate-500 dark:text-slate-400">Incorrect</div>
                            </div>
                            <div>
                                <div class="text-2xl font-bold text-slate-600 dark:text-slate-300">${total}</div>
                                <div class="text-xs text-slate-500 dark:text-slate-400">Total</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mb-6">
                        <div class="w-full bg-slate-200 dark:bg-slate-600 rounded-full h-4 overflow-hidden">
                            <div class="h-4 rounded-full transition-all duration-500 ${percentage >= 80 ? 'bg-green-500' : percentage >= 60 ? 'bg-yellow-500' : 'bg-red-500'}" style="width: ${percentage}%"></div>
                        </div>
                        <p class="text-sm text-slate-500 dark:text-slate-400 mt-2">${answered} of ${total} questions answered</p>
                    </div>
                    
                    <div class="flex flex-col sm:flex-row gap-3 justify-center">
                        <button onclick="reviewAnswers()" class="px-6 py-3 bg-blue-600 dark:bg-blue-500 text-white rounded-lg font-medium hover:bg-blue-700 dark:hover:bg-blue-600 transition-colors">
                            <i class="fa-solid fa-magnifying-glass mr-2"></i>Review Answers
                        </button>
                        <button onclick="retakeQuiz()" class="px-6 py-3 bg-slate-200 dark:bg-slate-600 text-slate-700 dark:text-slate-200 rounded-lg font-medium hover:bg-slate-300 dark:hover:bg-slate-500 transition-colors">
                            <i class="fa-solid fa-rotate-right mr-2"></i>Retake Quiz
                        </button>
                    </div>
                </div>
            `;
            
            // Hide navigation buttons and question navigator
            document.getElementById('quiz-controls').style.display = 'none';
            document.getElementById('question-nav').style.display = 'none';
            progressBar.style.width = '100%';
        }
        
        function reviewAnswers() {
            // Reveal all answers and go to first question
            filteredQuizData.forEach(q => {
                revealState[q.id] = true;
            });
            currentQuestionIndex = 0;
            document.getElementById('quiz-controls').style.display = 'flex';
            document.getElementById('question-nav').style.display = 'block';
            renderQuestion();
        }
        
        function retakeQuiz() {
            // Reset all answers and state
            filteredQuizData.forEach(q => {
                userAnswers[q.id] = null;
                revealState[q.id] = false;
                matchingSelections[q.id] = {};
            });
            currentQuestionIndex = 0;
            document.getElementById('quiz-controls').style.display = 'flex';
            document.getElementById('question-nav').style.display = 'block';
            renderQuestion();
        }

        // Dark mode toggle function
        function toggleDarkMode() {
            document.documentElement.classList.toggle('dark');
            localStorage.setItem('darkMode', document.documentElement.classList.contains('dark'));
        }
        
        // Initialize dark mode from localStorage or system preference
        function initDarkMode() {
            const stored = localStorage.getItem('darkMode');
            if (stored !== null) {
                if (stored === 'true') document.documentElement.classList.add('dark');
            } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
                document.documentElement.classList.add('dark');
            }
        }
        
        initDarkMode();
        initQuiz();
    </script>
</body>
</html>